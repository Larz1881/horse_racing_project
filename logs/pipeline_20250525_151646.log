2025-05-25 15:16:46,006 - __main__ - INFO - Pipeline started. Project Root: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project
2025-05-25 15:16:46,006 - __main__ - INFO - Using settings: RAW_DATA_DIR=C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw, PROCESSED_DATA_DIR=C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed, CACHE_DIR=C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\cache
2025-05-25 15:16:46,006 - __main__ - INFO - === Starting Horse Racing Data Pipeline ===
2025-05-25 15:16:46,007 - __main__ - INFO - Searching for DRF files in: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw with pattern: '*DRF'
2025-05-25 15:16:46,007 - __main__ - INFO - Using DRF file: PIM0509.DRF
2025-05-25 15:16:46,007 - __main__ - INFO - --- Step 1: Parsing DRF file (using src/parsers/bris_spec_new.py) ---
2025-05-25 15:16:46,008 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() starting ---
2025-05-25 15:16:46,008 - src.parsers.bris_spec_new - INFO - Processing DRF file provided as argument: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw\PIM0509.DRF
2025-05-25 15:16:46,008 - src.parsers.bris_spec_new - INFO - Loading specification cache from: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\cache\bris_spec.pkl
2025-05-25 15:16:46,019 - src.parsers.bris_spec_new - INFO - Parsing field types from: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw\bris_dict.txt
2025-05-25 15:16:46,038 - src.parsers.bris_spec_new - INFO - Parsed types for 190 fields from bris_dict.txt.
2025-05-25 15:16:46,039 - src.parsers.bris_spec_new - INFO - 
Attempting to parse PIM0509.DRF as comma-delimited...
2025-05-25 15:16:46,039 - src.parsers.bris_spec_new - INFO - Excluding columns starting with 'reserved'. Using 1321 out of 1435 columns.
2025-05-25 15:16:46,107 - src.parsers.bris_spec_new - INFO - Parsing successful. Read 92 lines from PIM0509.DRF.
2025-05-25 15:16:46,107 - src.parsers.bris_spec_new - INFO - 
Identifying column types using parsed bris_dict.txt info...
2025-05-25 15:16:46,131 - src.parsers.bris_spec_new - INFO - Identified 123 numeric columns using spec.
2025-05-25 15:16:46,131 - src.parsers.bris_spec_new - INFO - Identified 21 date columns using spec.
2025-05-25 15:16:46,131 - src.parsers.bris_spec_new - INFO - 
Attempting data type conversions...
2025-05-25 15:16:46,133 - src.parsers.bris_spec_new - INFO - Converting 123 columns to numeric...
2025-05-25 15:16:46,146 - src.parsers.bris_spec_new - INFO - Successfully converted 123 numeric columns.
2025-05-25 15:16:46,146 - src.parsers.bris_spec_new - INFO - Converting 21 columns to datetime...
2025-05-25 15:16:46,154 - src.parsers.bris_spec_new - INFO - Successfully converted 21 date columns.
2025-05-25 15:16:46,171 - src.parsers.bris_spec_new - INFO - 
Saving the processed data to Parquet file: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-05-25 15:16:46,694 - src.parsers.bris_spec_new - INFO - 
Successfully saved final data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-05-25 15:16:46,695 - src.parsers.bris_spec_new - INFO - Final DataFrame shape: (92, 1332)
2025-05-25 15:16:46,695 - src.parsers.bris_spec_new - INFO - Final DataFrame Info:
2025-05-25 15:16:46,695 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() finished ---
2025-05-25 15:16:46,697 - __main__ - INFO - --- Step 1: Parsing DRF file completed ---
2025-05-25 15:16:46,697 - __main__ - INFO - --- Step 2: Creating current race info ---
2025-05-25 15:16:50,942 - src.transformers.current_race_info - INFO - --- Creating Current Race Info File (2025-05-25 15:16:50 EDT) ---
2025-05-25 15:16:50,943 - src.transformers.current_race_info - INFO - Loading wide format data from: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-05-25 15:16:51,759 - src.transformers.current_race_info - INFO - Loaded wide data with shape: (92, 1332)
2025-05-25 15:16:51,763 - src.transformers.current_race_info - INFO - 
Dropping 1018 wide workout/past performance columns...
2025-05-25 15:16:51,774 - src.transformers.current_race_info - INFO - DataFrame shape after dropping columns: (92, 335)
2025-05-25 15:16:51,775 - src.transformers.current_race_info - INFO - Number of columns actually dropped: 997
2025-05-25 15:16:51,776 - src.transformers.current_race_info - INFO - 
Saving current race info data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\current_race_info.parquet
2025-05-25 15:16:51,844 - src.transformers.current_race_info - INFO - Save complete.
2025-05-25 15:16:51,844 - src.transformers.current_race_info - INFO - 
Output DataFrame Info:
2025-05-25 15:16:51,845 - src.transformers.current_race_info - INFO - 
--- Script Finished (2025-05-25 15:16:51 EDT) ---
2025-05-25 15:16:51,846 - __main__ - INFO - --- Step 2: Creating current race info completed ---
2025-05-25 15:16:51,846 - __main__ - INFO - --- Step 3: Transforming workouts ---
2025-05-25 15:16:51,847 - src.transformers.transform_workouts - INFO - --- Starting Workout Data Reshaping (2025-05-25 15:16:51 EDT) ---
2025-05-25 15:16:51,973 - src.transformers.transform_workouts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-05-25 15:16:51,973 - src.transformers.transform_workouts - INFO - Reshaping workout data using specification (Field# -> Actual Column Label)...
2025-05-25 15:16:51,993 - src.transformers.transform_workouts - INFO - Concatenating data for all workouts...
2025-05-25 15:16:51,995 - src.transformers.transform_workouts - INFO - Raw concatenated workout data shape: (1104, 14)
2025-05-25 15:16:51,999 - src.transformers.transform_workouts - INFO - Saving long format workout data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\workouts_long_format.parquet
2025-05-25 15:16:52,004 - src.transformers.transform_workouts - INFO - Save complete.
2025-05-25 15:16:52,004 - src.transformers.transform_workouts - INFO - Output DataFrame Info:
2025-05-25 15:16:52,008 - src.transformers.transform_workouts - INFO - --- Workout Reshaping Script Finished (2025-05-25 15:16:52 EDT) ---
2025-05-25 15:16:52,009 - __main__ - INFO - --- Step 3: Transforming workouts completed ---
2025-05-25 15:16:52,010 - __main__ - INFO - --- Step 4: Transforming past starts ---
2025-05-25 15:16:52,010 - src.transformers.transform_past_starts - INFO - --- Starting Past Performance Data Reshaping (2025-05-25 15:16:52 EDT) ---
2025-05-25 15:16:52,126 - src.transformers.transform_past_starts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-05-25 15:16:52,126 - src.transformers.transform_past_starts - INFO - Reshaping past performance data using specification and pd.melt...
2025-05-25 15:16:52,417 - src.transformers.transform_past_starts - INFO - Joining 94 melted metric DataFrames...
2025-05-25 15:16:52,417 - src.transformers.transform_past_starts - INFO -   Starting join with 'pp_race_date' (920 rows)
2025-05-25 15:16:52,418 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_days_since_prev' (828 rows)
2025-05-25 15:16:52,420 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 7)
2025-05-25 15:16:52,421 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code' (920 rows)
2025-05-25 15:16:52,424 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 8)
2025-05-25 15:16:52,424 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code_bris' (920 rows)
2025-05-25 15:16:52,431 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 9)
2025-05-25 15:16:52,432 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_num' (920 rows)
2025-05-25 15:16:52,434 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 10)
2025-05-25 15:16:52,435 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_condition' (920 rows)
2025-05-25 15:16:52,438 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 11)
2025-05-25 15:16:52,438 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_distance' (920 rows)
2025-05-25 15:16:52,441 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 12)
2025-05-25 15:16:52,441 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_surface' (920 rows)
2025-05-25 15:16:52,444 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 13)
2025-05-25 15:16:52,444 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_chute_indicator' (920 rows)
2025-05-25 15:16:52,447 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 14)
2025-05-25 15:16:52,448 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_num_entrants' (920 rows)
2025-05-25 15:16:52,449 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 15)
2025-05-25 15:16:52,450 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_post_position' (920 rows)
2025-05-25 15:16:52,452 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 16)
2025-05-25 15:16:52,453 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_equipment' (920 rows)
2025-05-25 15:16:52,456 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 17)
2025-05-25 15:16:52,457 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_racename' (920 rows)
2025-05-25 15:16:52,459 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 18)
2025-05-25 15:16:52,461 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_medication' (920 rows)
2025-05-25 15:16:52,467 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 19)
2025-05-25 15:16:52,468 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trip_comment' (920 rows)
2025-05-25 15:16:52,471 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 20)
2025-05-25 15:16:52,471 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_name' (920 rows)
2025-05-25 15:16:52,475 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 21)
2025-05-25 15:16:52,475 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_name' (920 rows)
2025-05-25 15:16:52,478 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 22)
2025-05-25 15:16:52,479 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_name' (920 rows)
2025-05-25 15:16:52,482 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 23)
2025-05-25 15:16:52,482 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_weight' (920 rows)
2025-05-25 15:16:52,486 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 24)
2025-05-25 15:16:52,487 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_weight' (920 rows)
2025-05-25 15:16:52,491 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 25)
2025-05-25 15:16:52,492 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_weight' (920 rows)
2025-05-25 15:16:52,496 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 26)
2025-05-25 15:16:52,498 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_margin' (920 rows)
2025-05-25 15:16:52,504 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 27)
2025-05-25 15:16:52,506 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_margin' (920 rows)
2025-05-25 15:16:52,509 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 28)
2025-05-25 15:16:52,511 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_margin' (920 rows)
2025-05-25 15:16:52,514 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 29)
2025-05-25 15:16:52,515 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_extra_comment' (920 rows)
2025-05-25 15:16:52,518 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 30)
2025-05-25 15:16:52,519 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_weight_carried' (920 rows)
2025-05-25 15:16:52,522 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 31)
2025-05-25 15:16:52,523 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_odds' (920 rows)
2025-05-25 15:16:52,525 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 32)
2025-05-25 15:16:52,526 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_entry_indicator' (920 rows)
2025-05-25 15:16:52,530 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 33)
2025-05-25 15:16:52,530 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_classification' (920 rows)
2025-05-25 15:16:52,533 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 34)
2025-05-25 15:16:52,533 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claiming_price' (920 rows)
2025-05-25 15:16:52,536 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 35)
2025-05-25 15:16:52,544 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_purse' (920 rows)
2025-05-25 15:16:52,548 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 36)
2025-05-25 15:16:52,548 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_call_pos' (920 rows)
2025-05-25 15:16:52,551 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 37)
2025-05-25 15:16:52,552 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_pos' (920 rows)
2025-05-25 15:16:52,555 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 38)
2025-05-25 15:16:52,555 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_pos' (920 rows)
2025-05-25 15:16:52,558 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 39)
2025-05-25 15:16:52,559 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_gate_call_pos' (920 rows)
2025-05-25 15:16:52,562 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 40)
2025-05-25 15:16:52,563 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_pos' (920 rows)
2025-05-25 15:16:52,566 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 41)
2025-05-25 15:16:52,567 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_pos' (920 rows)
2025-05-25 15:16:52,569 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 42)
2025-05-25 15:16:52,570 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_money_pos' (920 rows)
2025-05-25 15:16:52,575 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 43)
2025-05-25 15:16:52,576 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_leader' (920 rows)
2025-05-25 15:16:52,579 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 44)
2025-05-25 15:16:52,580 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_behind' (920 rows)
2025-05-25 15:16:52,583 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 45)
2025-05-25 15:16:52,584 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_leader' (920 rows)
2025-05-25 15:16:52,587 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 46)
2025-05-25 15:16:52,587 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_behind' (920 rows)
2025-05-25 15:16:52,590 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 47)
2025-05-25 15:16:52,591 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_leader' (920 rows)
2025-05-25 15:16:52,594 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 48)
2025-05-25 15:16:52,595 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_behind' (920 rows)
2025-05-25 15:16:52,599 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 49)
2025-05-25 15:16:52,599 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_1st_call' (920 rows)
2025-05-25 15:16:52,603 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 50)
2025-05-25 15:16:52,603 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_leader' (920 rows)
2025-05-25 15:16:52,606 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 51)
2025-05-25 15:16:52,607 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_behind' (920 rows)
2025-05-25 15:16:52,610 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 52)
2025-05-25 15:16:52,610 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_winner' (920 rows)
2025-05-25 15:16:52,613 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 53)
2025-05-25 15:16:52,614 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_behind' (920 rows)
2025-05-25 15:16:52,617 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 54)
2025-05-25 15:16:52,617 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_2nd_call' (920 rows)
2025-05-25 15:16:52,621 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 55)
2025-05-25 15:16:52,622 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_2f_pace' (920 rows)
2025-05-25 15:16:52,625 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 56)
2025-05-25 15:16:52,626 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_4f_pace' (920 rows)
2025-05-25 15:16:52,630 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 57)
2025-05-25 15:16:52,631 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_6f_pace' (920 rows)
2025-05-25 15:16:52,635 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 58)
2025-05-25 15:16:52,636 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_8f_pace' (920 rows)
2025-05-25 15:16:52,641 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 59)
2025-05-25 15:16:52,641 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_10f_pace' (920 rows)
2025-05-25 15:16:52,645 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 60)
2025-05-25 15:16:52,645 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_late_pace' (920 rows)
2025-05-25 15:16:52,648 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 61)
2025-05-25 15:16:52,648 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_rating' (920 rows)
2025-05-25 15:16:52,651 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 62)
2025-05-25 15:16:52,652 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_speed_rating_alt' (920 rows)
2025-05-25 15:16:52,655 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 63)
2025-05-25 15:16:52,655 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_variant' (920 rows)
2025-05-25 15:16:52,659 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 64)
2025-05-25 15:16:52,659 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_2f' (920 rows)
2025-05-25 15:16:52,662 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 65)
2025-05-25 15:16:52,663 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_3f' (920 rows)
2025-05-25 15:16:52,666 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 66)
2025-05-25 15:16:52,666 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_4f' (920 rows)
2025-05-25 15:16:52,669 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 67)
2025-05-25 15:16:52,670 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_5f' (920 rows)
2025-05-25 15:16:52,673 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 68)
2025-05-25 15:16:52,673 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_6f' (920 rows)
2025-05-25 15:16:52,676 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 69)
2025-05-25 15:16:52,676 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_7f' (920 rows)
2025-05-25 15:16:52,680 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 70)
2025-05-25 15:16:52,680 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_8f' (920 rows)
2025-05-25 15:16:52,685 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 71)
2025-05-25 15:16:52,685 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_10f' (920 rows)
2025-05-25 15:16:52,688 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 72)
2025-05-25 15:16:52,689 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_12f' (920 rows)
2025-05-25 15:16:52,691 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 73)
2025-05-25 15:16:52,693 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_14f' (920 rows)
2025-05-25 15:16:52,695 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 74)
2025-05-25 15:16:52,697 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_16f' (920 rows)
2025-05-25 15:16:52,699 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 75)
2025-05-25 15:16:52,700 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_1' (920 rows)
2025-05-25 15:16:52,703 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 76)
2025-05-25 15:16:52,704 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_2' (920 rows)
2025-05-25 15:16:52,706 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 77)
2025-05-25 15:16:52,707 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_3' (920 rows)
2025-05-25 15:16:52,710 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 78)
2025-05-25 15:16:52,711 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_final_time' (920 rows)
2025-05-25 15:16:52,714 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 79)
2025-05-25 15:16:52,715 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claimed_code' (920 rows)
2025-05-25 15:16:52,717 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 80)
2025-05-25 15:16:52,717 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trainer' (920 rows)
2025-05-25 15:16:52,721 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 81)
2025-05-25 15:16:52,722 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_jockey' (920 rows)
2025-05-25 15:16:52,726 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 82)
2025-05-25 15:16:52,727 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_apprentice_allow' (920 rows)
2025-05-25 15:16:52,729 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 83)
2025-05-25 15:16:52,731 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_type' (920 rows)
2025-05-25 15:16:52,734 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 84)
2025-05-25 15:16:52,735 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_age_sex_restrict' (920 rows)
2025-05-25 15:16:52,737 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 85)
2025-05-25 15:16:52,738 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_statebred_flag' (920 rows)
2025-05-25 15:16:52,745 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 86)
2025-05-25 15:16:52,746 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_restricted_flag' (920 rows)
2025-05-25 15:16:52,753 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 87)
2025-05-25 15:16:52,754 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_favorite_indicator' (920 rows)
2025-05-25 15:16:52,758 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 88)
2025-05-25 15:16:52,758 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_front_bandages' (920 rows)
2025-05-25 15:16:52,766 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 89)
2025-05-25 15:16:52,767 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_par' (920 rows)
2025-05-25 15:16:52,771 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 90)
2025-05-25 15:16:52,772 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bar_shoe' (920 rows)
2025-05-25 15:16:52,776 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 91)
2025-05-25 15:16:52,777 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_company_line' (920 rows)
2025-05-25 15:16:52,781 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 92)
2025-05-25 15:16:52,782 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_low_claiming' (920 rows)
2025-05-25 15:16:52,786 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 93)
2025-05-25 15:16:52,786 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_high_claiming' (920 rows)
2025-05-25 15:16:52,790 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 94)
2025-05-25 15:16:52,790 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_misc_code' (920 rows)
2025-05-25 15:16:52,795 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 95)
2025-05-25 15:16:52,796 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_ext_start_comment' (920 rows)
2025-05-25 15:16:52,800 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 96)
2025-05-25 15:16:52,801 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_sealed_track' (920 rows)
2025-05-25 15:16:52,803 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 97)
2025-05-25 15:16:52,804 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_aw_surface_flag' (920 rows)
2025-05-25 15:16:52,807 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 98)
2025-05-25 15:16:52,808 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_eqb_conditions' (920 rows)
2025-05-25 15:16:52,812 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 99)
2025-05-25 15:16:52,831 - src.transformers.transform_past_starts - INFO -   Added 'pp_distance_type' classification to past starts.
2025-05-25 15:16:53,017 - src.transformers.transform_past_starts - INFO - Saving long format past performance data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\past_starts_long_format.parquet
2025-05-25 15:16:53,034 - src.transformers.transform_past_starts - INFO - Save complete.
2025-05-25 15:16:53,034 - src.transformers.transform_past_starts - INFO - Output DataFrame Info:
2025-05-25 15:16:53,037 - src.transformers.transform_past_starts - INFO - --- Past Performance Reshaping Script Finished (2025-05-25 15:16:53 EDT) ---
2025-05-25 15:16:53,040 - __main__ - INFO - --- Step 4: Transforming past starts completed ---
2025-05-25 15:16:53,040 - __main__ - INFO - --- Step 5: Engineering features ---
2025-05-25 15:16:53,041 - src.transformers.feature_engineering - INFO - --- Starting Feature Engineering (2025-05-25 15:16:53 EDT) ---
2025-05-25 15:16:53,041 - src.transformers.feature_engineering - INFO - Loading data from: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-05-25 15:16:53,132 - src.transformers.feature_engineering - INFO - Loaded data with shape: (92, 1332)
2025-05-25 15:16:53,132 - src.transformers.feature_engineering - INFO - Computing record statistics...
2025-05-25 15:16:53,140 - src.transformers.feature_engineering - INFO - Created performance DataFrame with shape: (92, 25)
2025-05-25 15:16:53,140 - src.transformers.feature_engineering - INFO - Computing fractional splits...
2025-05-25 15:16:53,151 - src.transformers.feature_engineering - INFO - Created splits DataFrame with shape: (92, 80)
2025-05-25 15:16:53,151 - src.transformers.feature_engineering - INFO - Saving horse_performance.csv to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\horse_performance.csv
2025-05-25 15:16:53,156 - src.transformers.feature_engineering - INFO - Saving splits.csv to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\splits.csv
2025-05-25 15:16:53,163 - src.transformers.feature_engineering - INFO - Processing jockey statistics...
2025-05-25 15:16:53,167 - src.transformers.feature_engineering - INFO - Saving jockey_performance.parquet to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\jockey_performance.parquet
2025-05-25 15:16:53,170 - src.transformers.feature_engineering - INFO - --- Feature Engineering Script Finished ---
2025-05-25 15:16:53,173 - __main__ - INFO - --- Step 5: Engineering features completed ---
2025-05-25 15:16:53,173 - __main__ - INFO - === Pipeline completed successfully! ===
