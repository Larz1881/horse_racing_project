2025-05-31 20:04:39,620 - __main__ - INFO - Pipeline started. Project Root: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project
2025-05-31 20:04:39,621 - __main__ - INFO - Using settings: RAW_DATA_DIR=C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw, PROCESSED_DATA_DIR=C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed, CACHE_DIR=C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\cache
2025-05-31 20:04:39,621 - __main__ - INFO - === Starting Horse Racing Data Pipeline ===
2025-05-31 20:04:39,631 - __main__ - INFO - Searching for DRF files in: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw with pattern: '*DRF'
2025-05-31 20:04:39,633 - __main__ - INFO - Using DRF file: PIM0509.DRF
2025-05-31 20:04:39,633 - __main__ - INFO - --- Step 1: Parsing DRF file (using src/parsers/bris_spec_new.py) ---
2025-05-31 20:04:39,634 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() starting ---
2025-05-31 20:04:39,634 - src.parsers.bris_spec_new - INFO - Processing DRF file provided as argument: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw\PIM0509.DRF
2025-05-31 20:04:39,634 - src.parsers.bris_spec_new - INFO - Loading specification cache from: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\cache\bris_spec.pkl
2025-05-31 20:04:39,637 - src.parsers.bris_spec_new - INFO - Parsing field types from: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\raw\bris_dict.txt
2025-05-31 20:04:39,647 - src.parsers.bris_spec_new - INFO - Parsed types for 190 fields from bris_dict.txt.
2025-05-31 20:04:39,648 - src.parsers.bris_spec_new - INFO - 
Attempting to parse PIM0509.DRF as comma-delimited...
2025-05-31 20:04:39,649 - src.parsers.bris_spec_new - INFO - Excluding columns starting with 'reserved'. Using 1321 out of 1435 columns.
2025-05-31 20:04:39,728 - src.parsers.bris_spec_new - INFO - Parsing successful. Read 92 lines from PIM0509.DRF.
2025-05-31 20:04:39,728 - src.parsers.bris_spec_new - INFO - 
Identifying column types using parsed bris_dict.txt info...
2025-05-31 20:04:39,752 - src.parsers.bris_spec_new - INFO - Identified 123 numeric columns using spec.
2025-05-31 20:04:39,752 - src.parsers.bris_spec_new - INFO - Identified 21 date columns using spec.
2025-05-31 20:04:39,753 - src.parsers.bris_spec_new - INFO - 
Attempting data type conversions...
2025-05-31 20:04:39,753 - src.parsers.bris_spec_new - INFO - Converting 123 columns to numeric...
2025-05-31 20:04:39,767 - src.parsers.bris_spec_new - INFO - Successfully converted 123 numeric columns.
2025-05-31 20:04:39,768 - src.parsers.bris_spec_new - INFO - Converting 21 columns to datetime...
2025-05-31 20:04:39,776 - src.parsers.bris_spec_new - INFO - Successfully converted 21 date columns.
2025-05-31 20:04:39,785 - src.parsers.bris_spec_new - INFO - 
Saving the processed data to Parquet file: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-05-31 20:04:39,898 - src.parsers.bris_spec_new - INFO - 
Successfully saved final data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-05-31 20:04:39,899 - src.parsers.bris_spec_new - INFO - Final DataFrame shape: (92, 1332)
2025-05-31 20:04:39,900 - src.parsers.bris_spec_new - INFO - Final DataFrame Info:
2025-05-31 20:04:39,900 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() finished ---
2025-05-31 20:04:39,902 - __main__ - INFO - --- Step 1: Parsing DRF file completed ---
2025-05-31 20:04:39,902 - __main__ - INFO - --- Step 2: Creating current race info ---
2025-05-31 20:04:39,944 - src.transformers.current_race_info - INFO - --- Creating Current Race Info File (2025-05-31 20:04:39 EDT) ---
2025-05-31 20:04:39,945 - src.transformers.current_race_info - INFO - Loading wide format data from: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-05-31 20:04:40,053 - src.transformers.current_race_info - INFO - Loaded wide data with shape: (92, 1332)
2025-05-31 20:04:40,057 - src.transformers.current_race_info - INFO - 
Dropping 1018 wide workout/past performance columns...
2025-05-31 20:04:40,070 - src.transformers.current_race_info - INFO - DataFrame shape after dropping columns: (92, 335)
2025-05-31 20:04:40,071 - src.transformers.current_race_info - INFO - Number of columns actually dropped: 997
2025-05-31 20:04:40,071 - src.transformers.current_race_info - INFO - 
Saving current race info data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\current_race_info.parquet
2025-05-31 20:04:40,119 - src.transformers.current_race_info - INFO - Save complete.
2025-05-31 20:04:40,119 - src.transformers.current_race_info - INFO - 
Output DataFrame Info:
2025-05-31 20:04:40,119 - src.transformers.current_race_info - INFO - 
--- Script Finished (2025-05-31 20:04:40 EDT) ---
2025-05-31 20:04:40,122 - __main__ - INFO - --- Step 2: Creating current race info completed ---
2025-05-31 20:04:40,122 - __main__ - INFO - --- Step 3: Transforming workouts ---
2025-05-31 20:04:40,123 - src.transformers.transform_workouts - INFO - --- Starting Workout Data Reshaping (2025-05-31 20:04:40 EDT) ---
2025-05-31 20:04:40,216 - src.transformers.transform_workouts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-05-31 20:04:40,216 - src.transformers.transform_workouts - INFO - Reshaping workout data using specification (Field# -> Actual Column Label)...
2025-05-31 20:04:40,225 - src.transformers.transform_workouts - INFO - Concatenating data for all workouts...
2025-05-31 20:04:40,228 - src.transformers.transform_workouts - INFO - Raw concatenated workout data shape: (1104, 14)
2025-05-31 20:04:40,233 - src.transformers.transform_workouts - INFO - Saving long format workout data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\workouts_long_format.parquet
2025-05-31 20:04:40,237 - src.transformers.transform_workouts - INFO - Save complete.
2025-05-31 20:04:40,237 - src.transformers.transform_workouts - INFO - Output DataFrame Info:
2025-05-31 20:04:40,240 - src.transformers.transform_workouts - INFO - --- Workout Reshaping Script Finished (2025-05-31 20:04:40 EDT) ---
2025-05-31 20:04:40,242 - __main__ - INFO - --- Step 3: Transforming workouts completed ---
2025-05-31 20:04:40,242 - __main__ - INFO - --- Step 4: Transforming past starts ---
2025-05-31 20:04:40,242 - src.transformers.transform_past_starts - INFO - --- Starting Past Performance Data Reshaping (2025-05-31 20:04:40 EDT) ---
2025-05-31 20:04:40,331 - src.transformers.transform_past_starts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-05-31 20:04:40,331 - src.transformers.transform_past_starts - INFO - Reshaping past performance data using specification and pd.melt...
2025-05-31 20:04:40,583 - src.transformers.transform_past_starts - INFO - Joining 94 melted metric DataFrames...
2025-05-31 20:04:40,585 - src.transformers.transform_past_starts - INFO -   Starting join with 'pp_race_date' (920 rows)
2025-05-31 20:04:40,585 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_days_since_prev' (828 rows)
2025-05-31 20:04:40,588 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 7)
2025-05-31 20:04:40,589 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code' (920 rows)
2025-05-31 20:04:40,591 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 8)
2025-05-31 20:04:40,592 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code_bris' (920 rows)
2025-05-31 20:04:40,593 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 9)
2025-05-31 20:04:40,595 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_num' (920 rows)
2025-05-31 20:04:40,597 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 10)
2025-05-31 20:04:40,598 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_condition' (920 rows)
2025-05-31 20:04:40,600 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 11)
2025-05-31 20:04:40,600 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_distance' (920 rows)
2025-05-31 20:04:40,603 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 12)
2025-05-31 20:04:40,603 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_surface' (920 rows)
2025-05-31 20:04:40,605 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 13)
2025-05-31 20:04:40,606 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_chute_indicator' (920 rows)
2025-05-31 20:04:40,608 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 14)
2025-05-31 20:04:40,609 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_num_entrants' (920 rows)
2025-05-31 20:04:40,611 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 15)
2025-05-31 20:04:40,612 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_post_position' (920 rows)
2025-05-31 20:04:40,614 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 16)
2025-05-31 20:04:40,614 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_equipment' (920 rows)
2025-05-31 20:04:40,617 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 17)
2025-05-31 20:04:40,617 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_racename' (920 rows)
2025-05-31 20:04:40,619 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 18)
2025-05-31 20:04:40,620 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_medication' (920 rows)
2025-05-31 20:04:40,622 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 19)
2025-05-31 20:04:40,622 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trip_comment' (920 rows)
2025-05-31 20:04:40,624 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 20)
2025-05-31 20:04:40,624 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_name' (920 rows)
2025-05-31 20:04:40,627 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 21)
2025-05-31 20:04:40,627 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_name' (920 rows)
2025-05-31 20:04:40,630 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 22)
2025-05-31 20:04:40,631 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_name' (920 rows)
2025-05-31 20:04:40,633 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 23)
2025-05-31 20:04:40,634 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_weight' (920 rows)
2025-05-31 20:04:40,636 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 24)
2025-05-31 20:04:40,637 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_weight' (920 rows)
2025-05-31 20:04:40,639 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 25)
2025-05-31 20:04:40,640 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_weight' (920 rows)
2025-05-31 20:04:40,645 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 26)
2025-05-31 20:04:40,647 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_margin' (920 rows)
2025-05-31 20:04:40,649 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 27)
2025-05-31 20:04:40,650 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_margin' (920 rows)
2025-05-31 20:04:40,652 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 28)
2025-05-31 20:04:40,653 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_margin' (920 rows)
2025-05-31 20:04:40,655 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 29)
2025-05-31 20:04:40,656 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_extra_comment' (920 rows)
2025-05-31 20:04:40,659 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 30)
2025-05-31 20:04:40,659 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_weight_carried' (920 rows)
2025-05-31 20:04:40,662 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 31)
2025-05-31 20:04:40,662 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_odds' (920 rows)
2025-05-31 20:04:40,665 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 32)
2025-05-31 20:04:40,666 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_entry_indicator' (920 rows)
2025-05-31 20:04:40,668 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 33)
2025-05-31 20:04:40,668 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_classification' (920 rows)
2025-05-31 20:04:40,671 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 34)
2025-05-31 20:04:40,672 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claiming_price' (920 rows)
2025-05-31 20:04:40,675 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 35)
2025-05-31 20:04:40,677 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_purse' (920 rows)
2025-05-31 20:04:40,679 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 36)
2025-05-31 20:04:40,680 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_call_pos' (920 rows)
2025-05-31 20:04:40,682 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 37)
2025-05-31 20:04:40,683 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_pos' (920 rows)
2025-05-31 20:04:40,685 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 38)
2025-05-31 20:04:40,686 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_pos' (920 rows)
2025-05-31 20:04:40,688 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 39)
2025-05-31 20:04:40,688 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_gate_call_pos' (920 rows)
2025-05-31 20:04:40,691 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 40)
2025-05-31 20:04:40,692 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_pos' (920 rows)
2025-05-31 20:04:40,694 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 41)
2025-05-31 20:04:40,695 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_pos' (920 rows)
2025-05-31 20:04:40,698 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 42)
2025-05-31 20:04:40,698 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_money_pos' (920 rows)
2025-05-31 20:04:40,701 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 43)
2025-05-31 20:04:40,701 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_leader' (920 rows)
2025-05-31 20:04:40,704 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 44)
2025-05-31 20:04:40,704 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_behind' (920 rows)
2025-05-31 20:04:40,707 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 45)
2025-05-31 20:04:40,708 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_leader' (920 rows)
2025-05-31 20:04:40,710 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 46)
2025-05-31 20:04:40,711 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_behind' (920 rows)
2025-05-31 20:04:40,714 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 47)
2025-05-31 20:04:40,714 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_leader' (920 rows)
2025-05-31 20:04:40,717 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 48)
2025-05-31 20:04:40,717 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_behind' (920 rows)
2025-05-31 20:04:40,720 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 49)
2025-05-31 20:04:40,721 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_1st_call' (920 rows)
2025-05-31 20:04:40,723 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 50)
2025-05-31 20:04:40,724 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_leader' (920 rows)
2025-05-31 20:04:40,726 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 51)
2025-05-31 20:04:40,727 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_behind' (920 rows)
2025-05-31 20:04:40,730 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 52)
2025-05-31 20:04:40,731 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_winner' (920 rows)
2025-05-31 20:04:40,733 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 53)
2025-05-31 20:04:40,734 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_behind' (920 rows)
2025-05-31 20:04:40,736 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 54)
2025-05-31 20:04:40,737 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_2nd_call' (920 rows)
2025-05-31 20:04:40,740 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 55)
2025-05-31 20:04:40,740 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_2f_pace' (920 rows)
2025-05-31 20:04:40,743 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 56)
2025-05-31 20:04:40,744 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_4f_pace' (920 rows)
2025-05-31 20:04:40,747 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 57)
2025-05-31 20:04:40,748 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_6f_pace' (920 rows)
2025-05-31 20:04:40,750 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 58)
2025-05-31 20:04:40,751 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_8f_pace' (920 rows)
2025-05-31 20:04:40,754 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 59)
2025-05-31 20:04:40,755 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_10f_pace' (920 rows)
2025-05-31 20:04:40,760 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 60)
2025-05-31 20:04:40,761 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_late_pace' (920 rows)
2025-05-31 20:04:40,765 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 61)
2025-05-31 20:04:40,765 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_rating' (920 rows)
2025-05-31 20:04:40,770 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 62)
2025-05-31 20:04:40,770 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_speed_rating_alt' (920 rows)
2025-05-31 20:04:40,773 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 63)
2025-05-31 20:04:40,774 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_variant' (920 rows)
2025-05-31 20:04:40,778 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 64)
2025-05-31 20:04:40,779 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_2f' (920 rows)
2025-05-31 20:04:40,782 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 65)
2025-05-31 20:04:40,784 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_3f' (920 rows)
2025-05-31 20:04:40,787 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 66)
2025-05-31 20:04:40,788 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_4f' (920 rows)
2025-05-31 20:04:40,792 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 67)
2025-05-31 20:04:40,794 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_5f' (920 rows)
2025-05-31 20:04:40,798 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 68)
2025-05-31 20:04:40,799 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_6f' (920 rows)
2025-05-31 20:04:40,802 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 69)
2025-05-31 20:04:40,803 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_7f' (920 rows)
2025-05-31 20:04:40,805 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 70)
2025-05-31 20:04:40,806 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_8f' (920 rows)
2025-05-31 20:04:40,811 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 71)
2025-05-31 20:04:40,812 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_10f' (920 rows)
2025-05-31 20:04:40,816 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 72)
2025-05-31 20:04:40,817 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_12f' (920 rows)
2025-05-31 20:04:40,820 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 73)
2025-05-31 20:04:40,821 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_14f' (920 rows)
2025-05-31 20:04:40,824 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 74)
2025-05-31 20:04:40,825 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_16f' (920 rows)
2025-05-31 20:04:40,828 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 75)
2025-05-31 20:04:40,829 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_1' (920 rows)
2025-05-31 20:04:40,832 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 76)
2025-05-31 20:04:40,832 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_2' (920 rows)
2025-05-31 20:04:40,835 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 77)
2025-05-31 20:04:40,836 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_3' (920 rows)
2025-05-31 20:04:40,839 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 78)
2025-05-31 20:04:40,840 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_final_time' (920 rows)
2025-05-31 20:04:40,843 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 79)
2025-05-31 20:04:40,844 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claimed_code' (920 rows)
2025-05-31 20:04:40,847 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 80)
2025-05-31 20:04:40,848 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trainer' (920 rows)
2025-05-31 20:04:40,851 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 81)
2025-05-31 20:04:40,852 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_jockey' (920 rows)
2025-05-31 20:04:40,855 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 82)
2025-05-31 20:04:40,856 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_apprentice_allow' (920 rows)
2025-05-31 20:04:40,859 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 83)
2025-05-31 20:04:40,860 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_type' (920 rows)
2025-05-31 20:04:40,864 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 84)
2025-05-31 20:04:40,864 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_age_sex_restrict' (920 rows)
2025-05-31 20:04:40,868 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 85)
2025-05-31 20:04:40,868 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_statebred_flag' (920 rows)
2025-05-31 20:04:40,872 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 86)
2025-05-31 20:04:40,872 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_restricted_flag' (920 rows)
2025-05-31 20:04:40,876 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 87)
2025-05-31 20:04:40,877 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_favorite_indicator' (920 rows)
2025-05-31 20:04:40,880 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 88)
2025-05-31 20:04:40,881 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_front_bandages' (920 rows)
2025-05-31 20:04:40,884 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 89)
2025-05-31 20:04:40,884 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_par' (920 rows)
2025-05-31 20:04:40,888 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 90)
2025-05-31 20:04:40,888 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bar_shoe' (920 rows)
2025-05-31 20:04:40,892 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 91)
2025-05-31 20:04:40,893 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_company_line' (920 rows)
2025-05-31 20:04:40,896 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 92)
2025-05-31 20:04:40,897 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_low_claiming' (920 rows)
2025-05-31 20:04:40,900 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 93)
2025-05-31 20:04:40,900 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_high_claiming' (920 rows)
2025-05-31 20:04:40,904 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 94)
2025-05-31 20:04:40,905 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_misc_code' (920 rows)
2025-05-31 20:04:40,908 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 95)
2025-05-31 20:04:40,908 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_ext_start_comment' (920 rows)
2025-05-31 20:04:40,912 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 96)
2025-05-31 20:04:40,913 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_sealed_track' (920 rows)
2025-05-31 20:04:40,916 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 97)
2025-05-31 20:04:40,917 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_aw_surface_flag' (920 rows)
2025-05-31 20:04:40,920 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 98)
2025-05-31 20:04:40,920 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_eqb_conditions' (920 rows)
2025-05-31 20:04:40,924 - src.transformers.transform_past_starts - INFO -   Shape after merge: (920, 99)
2025-05-31 20:04:40,954 - src.transformers.transform_past_starts - INFO -   Added 'pp_distance_type' classification to past starts.
2025-05-31 20:04:41,120 - src.transformers.transform_past_starts - INFO - Saving long format past performance data to: C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\data\processed\past_starts_long_format.parquet
2025-05-31 20:04:41,141 - src.transformers.transform_past_starts - INFO - Save complete.
2025-05-31 20:04:41,141 - src.transformers.transform_past_starts - INFO - Output DataFrame Info:
2025-05-31 20:04:41,145 - src.transformers.transform_past_starts - INFO - --- Past Performance Reshaping Script Finished (2025-05-31 20:04:41 EDT) ---
2025-05-31 20:04:41,147 - __main__ - INFO - --- Step 4: Transforming past starts completed ---
2025-05-31 20:04:41,147 - __main__ - INFO - --- Step 5: Engineering features ---
2025-05-31 20:04:41,598 - __main__ - INFO - --- Step 5: Engineering features completed ---
2025-05-31 20:04:41,598 - __main__ - INFO - Running advanced fitness metrics...
2025-05-31 20:04:41,661 - src.transformers.advanced_fitness_metrics - INFO - Calculating all advanced fitness metrics...
2025-05-31 20:04:41,661 - src.transformers.advanced_fitness_metrics - INFO - Calculating Recovery Rate Index...
2025-05-31 20:04:41,725 - src.transformers.advanced_fitness_metrics - INFO - Calculating Form Momentum Score...
2025-05-31 20:04:41,795 - src.transformers.advanced_fitness_metrics - INFO - Calculating Cardiovascular Fitness Proxy...
2025-05-31 20:04:41,824 - src.transformers.advanced_fitness_metrics - INFO - Calculating Sectional Improvement Index...
2025-05-31 20:04:41,841 - src.transformers.advanced_fitness_metrics - INFO - Calculating Energy Distribution Profile...
2025-05-31 20:04:41,902 - src.transformers.advanced_fitness_metrics - INFO - Calculating Workout Fitness Indicators...
2025-05-31 20:04:41,977 - src.transformers.advanced_fitness_metrics - INFO - Calculated fitness metrics for 92 horses
2025-05-31 20:04:41,986 - src.transformers.advanced_fitness_metrics - INFO - Saved fitness metrics to data\processed\advanced_fitness_metrics.parquet
2025-05-31 20:04:42,000 - __main__ - INFO - Running sophisticated workout analysis...
2025-05-31 20:04:42,044 - src.transformers.sophisticated_workout_analysis - INFO - Calculating all workout metrics...
2025-05-31 20:04:42,044 - src.transformers.sophisticated_workout_analysis - INFO - Calculating workout quality scores...
2025-05-31 20:04:42,155 - src.transformers.sophisticated_workout_analysis - INFO - Identifying trainer intent signals...
2025-05-31 20:04:42,349 - src.transformers.sophisticated_workout_analysis - INFO - Analyzed workouts for 92 horses
2025-05-31 20:04:42,349 - src.transformers.sophisticated_workout_analysis - INFO - Generating trainer pattern report...
2025-05-31 20:04:42,350 - src.transformers.sophisticated_workout_analysis - INFO - Analyzing trainer-specific workout patterns...
2025-05-31 20:04:42,447 - src.transformers.sophisticated_workout_analysis - INFO - Analyzing work-to-race translation...
2025-05-31 20:04:43,196 - src.transformers.sophisticated_workout_analysis - INFO - Saved workout analysis to data\processed\sophisticated_workout_analysis.parquet
2025-05-31 20:04:43,198 - src.transformers.sophisticated_workout_analysis - INFO - Saved trainer patterns to data\processed\trainer_workout_patterns.csv
2025-05-31 20:04:43,206 - src.transformers.sophisticated_workout_analysis - INFO - Saved translation analysis to data\processed\workout_race_translation.csv
2025-05-31 20:04:43,226 - __main__ - INFO - Running advanced pace projection...
2025-05-31 20:04:43,278 - src.transformers.advanced_pace_projection - INFO - Generating comprehensive pace report...
2025-05-31 20:04:43,278 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:43,411 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-05-31 20:04:43,412 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:43,543 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-05-31 20:04:43,543 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:43,662 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-05-31 20:04:43,663 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:43,798 - src.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-05-31 20:04:43,799 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-05-31 20:04:43,800 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:43,925 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-05-31 20:04:43,926 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:44,042 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-05-31 20:04:44,043 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:44,203 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-05-31 20:04:44,204 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:44,330 - src.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-05-31 20:04:44,331 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-05-31 20:04:44,332 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:44,457 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-05-31 20:04:44,458 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:44,572 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-05-31 20:04:44,572 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-05-31 20:04:44,719 - src.transformers.advanced_pace_projection - INFO - Saved pace analysis to data\processed\advanced_pace_analysis.parquet
2025-05-31 20:04:44,739 - __main__ - INFO - Running multi-dimensional class assessment...
2025-05-31 20:04:44,779 - src.transformers.multi_dimensional_class_assessment - INFO - Generating comprehensive class report...
2025-05-31 20:04:44,780 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating earnings-based class metrics...
2025-05-31 20:04:44,821 - src.transformers.multi_dimensional_class_assessment - INFO - Building race classification hierarchy...
2025-05-31 20:04:44,908 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating hidden class indicators...
2025-05-31 20:04:44,969 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating competitive level index...
2025-05-31 20:04:45,097 - src.transformers.multi_dimensional_class_assessment - INFO - Saved class assessment to data\processed\multi_dimensional_class_assessment.parquet
2025-05-31 20:04:45,119 - __main__ - INFO - Running form cycle detection...
2025-05-31 20:04:45,187 - src.transformers.form_cycle_detector - INFO - Generating comprehensive form cycle report...
2025-05-31 20:04:45,188 - src.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-05-31 20:04:45,282 - src.transformers.form_cycle_detector - INFO - Analyzing position call patterns...
2025-05-31 20:04:45,434 - src.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-05-31 20:04:45,480 - src.transformers.form_cycle_detector - INFO - Analyzing fractional time evolution...
2025-05-31 20:04:45,671 - src.transformers.form_cycle_detector - INFO - Calculating field-adjusted performance...
2025-05-31 20:04:45,720 - src.transformers.form_cycle_detector - INFO - Saved form cycle analysis to data\processed\form_cycle_analysis.parquet
2025-05-31 20:04:45,720 - src.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-05-31 20:04:45,814 - src.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-05-31 20:04:45,873 - __main__ - INFO - Running integrated analytics system...
2025-05-31 20:04:46,049 - src.transformers.integrated_analytics_system - INFO - Loading all analytical components...
2025-05-31 20:04:46,101 - src.transformers.integrated_analytics_system - INFO - Loaded fitness data: 92 records
2025-05-31 20:04:46,122 - src.transformers.integrated_analytics_system - INFO - Loaded workout data: 92 records
2025-05-31 20:04:46,134 - src.transformers.integrated_analytics_system - INFO - Loaded pace data: 85 records
2025-05-31 20:04:46,162 - src.transformers.integrated_analytics_system - INFO - Loaded class data: 92 records
2025-05-31 20:04:46,179 - src.transformers.integrated_analytics_system - INFO - Loaded form data: 92 records
2025-05-31 20:04:46,180 - src.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-05-31 20:04:46,180 - src.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-05-31 20:04:46,181 - src.transformers.integrated_analytics_system - INFO - Training form cycle state classifier...
2025-05-31 20:04:46,250 - src.transformers.integrated_analytics_system - INFO - Performing workout pattern clustering...
2025-05-31 20:04:46,382 - src.transformers.integrated_analytics_system - INFO - Training class trajectory predictor...
2025-05-31 20:04:46,574 - src.transformers.integrated_analytics_system - INFO - Training pace scenario optimizer...
2025-05-31 20:04:46,699 - src.transformers.integrated_analytics_system - INFO - Training integrated performance predictor...
2025-05-31 20:04:46,700 - src.transformers.integrated_analytics_system - INFO - Calculating composite fitness scores...
2025-05-31 20:04:46,805 - src.transformers.integrated_analytics_system - INFO - Performance predictor trained with 6 features: ['integrated_fitness_score', 'composite_fitness_score', 'workout_readiness_score', 'pace_advantage_score', 'overall_class_rating', 'composite_form_score']
2025-05-31 20:04:46,812 - src.transformers.integrated_analytics_system - INFO - Generating integrated analysis report...
2025-05-31 20:04:46,812 - src.transformers.integrated_analytics_system - INFO - Calculating composite fitness scores...
2025-05-31 20:04:46,821 - src.transformers.integrated_analytics_system - INFO - Calculating class-adjusted speed figures...
2025-05-31 20:04:46,918 - src.transformers.integrated_analytics_system - INFO - Calculating pace impact predictions...
2025-05-31 20:04:46,928 - src.transformers.integrated_analytics_system - INFO - Applied ML predictions using features: ['integrated_fitness_score', 'composite_fitness_score', 'workout_readiness_score', 'pace_advantage_score', 'overall_class_rating', 'composite_form_score']
2025-05-31 20:04:46,930 - __main__ - ERROR - Pipeline failed with an unexpected error: '>' not supported between instances of 'str' and 'int'
Traceback (most recent call last):
  File "c:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\run_pipeline.py", line 155, in run_complete_pipeline
    run_integrated_analytics()
  File "C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\src\transformers\integrated_analytics_system.py", line 1142, in main
    integrated_report = analytics.generate_integrated_report()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\src\transformers\integrated_analytics_system.py", line 1020, in generate_integrated_report
    report['key_angles'] = report.apply(self._identify_key_angles, axis=1)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nblza1\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 10374, in apply
    return op.apply().__finalize__(self, method="apply")
           ^^^^^^^^^^
  File "C:\Users\nblza1\AppData\Roaming\Python\Python312\site-packages\pandas\core\apply.py", line 916, in apply
    return self.apply_standard()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nblza1\AppData\Roaming\Python\Python312\site-packages\pandas\core\apply.py", line 1063, in apply_standard
    results, res_index = self.apply_series_generator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nblza1\AppData\Roaming\Python\Python312\site-packages\pandas\core\apply.py", line 1081, in apply_series_generator
    results[i] = self.func(v, *self.args, **self.kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nblza1\OneDrive - NBIM\Documents\Coding\horse_racing_project\src\transformers\integrated_analytics_system.py", line 1050, in _identify_key_angles
    if (row.get('morn_line_odds_if_available', 0) > 10 and
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '>' not supported between instances of 'str' and 'int'
