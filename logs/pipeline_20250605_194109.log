2025-06-05 19:41:09,123 - __main__ - INFO - Pipeline started. Project Root: C:\Users\Larry\Documents\horse_racing_project
2025-06-05 19:41:09,124 - __main__ - INFO - Using settings: RAW_DATA_DIR=C:\Users\Larry\Documents\horse_racing_project\data\raw, PROCESSED_DATA_DIR=C:\Users\Larry\Documents\horse_racing_project\data\processed, CACHE_DIR=C:\Users\Larry\Documents\horse_racing_project\data\cache
2025-06-05 19:41:09,124 - __main__ - INFO - === Starting Horse Racing Data Pipeline ===
2025-06-05 19:41:09,125 - __main__ - INFO - Searching for DRF files in: C:\Users\Larry\Documents\horse_racing_project\data\raw with pattern: '*DRF'
2025-06-05 19:41:09,127 - __main__ - INFO - Using DRF file: SAR0606.DRF
2025-06-05 19:41:09,127 - __main__ - INFO - --- Step 1: Parsing DRF file (using horse_racing/parsers/bris_spec_new.py) ---
2025-06-05 19:41:09,128 - horse_racing.parsers.bris_spec_new - INFO - --- bris_spec_new.main() starting ---
2025-06-05 19:41:09,129 - horse_racing.parsers.bris_spec_new - INFO - Processing DRF file provided as argument: C:\Users\Larry\Documents\horse_racing_project\data\raw\SAR0606.DRF
2025-06-05 19:41:09,129 - horse_racing.parsers.bris_spec_new - INFO - Loading specification cache from: C:\Users\Larry\Documents\horse_racing_project\data\cache\bris_spec.pkl
2025-06-05 19:41:09,150 - horse_racing.parsers.bris_spec_new - INFO - Parsing field types from: C:\Users\Larry\Documents\horse_racing_project\data\raw\bris_dict.txt
2025-06-05 19:41:09,187 - horse_racing.parsers.bris_spec_new - INFO - Parsed types for 190 fields from bris_dict.txt.
2025-06-05 19:41:09,188 - horse_racing.parsers.bris_spec_new - INFO - 
Attempting to parse SAR0606.DRF as comma-delimited...
2025-06-05 19:41:09,188 - horse_racing.parsers.bris_spec_new - INFO - Excluding columns starting with 'reserved'. Using 1321 out of 1435 columns.
2025-06-05 19:41:09,373 - horse_racing.parsers.bris_spec_new - INFO - Parsing successful. Read 154 lines from SAR0606.DRF.
2025-06-05 19:41:09,373 - horse_racing.parsers.bris_spec_new - INFO - 
Identifying column types using parsed bris_dict.txt info...
2025-06-05 19:41:09,456 - horse_racing.parsers.bris_spec_new - INFO - Identified 123 numeric columns using spec.
2025-06-05 19:41:09,457 - horse_racing.parsers.bris_spec_new - INFO - Identified 21 date columns using spec.
2025-06-05 19:41:09,457 - horse_racing.parsers.bris_spec_new - INFO - 
Attempting data type conversions...
2025-06-05 19:41:09,460 - horse_racing.parsers.bris_spec_new - INFO - Converting 123 columns to numeric...
2025-06-05 19:41:09,499 - horse_racing.parsers.bris_spec_new - INFO - Successfully converted 123 numeric columns.
2025-06-05 19:41:09,500 - horse_racing.parsers.bris_spec_new - INFO - Converting 21 columns to datetime...
2025-06-05 19:41:09,521 - horse_racing.parsers.bris_spec_new - INFO - Successfully converted 21 date columns.
2025-06-05 19:41:09,544 - horse_racing.parsers.bris_spec_new - INFO - 
Saving the processed data to Parquet file: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-05 19:41:10,130 - horse_racing.parsers.bris_spec_new - INFO - 
Successfully saved final data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-05 19:41:10,130 - horse_racing.parsers.bris_spec_new - INFO - Final DataFrame shape: (154, 1332)
2025-06-05 19:41:10,131 - horse_racing.parsers.bris_spec_new - INFO - Final DataFrame Info:
2025-06-05 19:41:10,131 - horse_racing.parsers.bris_spec_new - INFO - --- bris_spec_new.main() finished ---
2025-06-05 19:41:10,135 - __main__ - INFO - --- Step 1: Parsing DRF file completed ---
2025-06-05 19:41:10,135 - __main__ - INFO - --- Step 2: Creating current race info ---
2025-06-05 19:41:14,078 - horse_racing.transformers.current_race_info - INFO - --- Creating Current Race Info File (2025-06-05 19:41:14 EDT) ---
2025-06-05 19:41:14,078 - horse_racing.transformers.current_race_info - INFO - Loading wide format data from: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-05 19:41:14,863 - horse_racing.transformers.current_race_info - INFO - Loaded wide data with shape: (154, 1332)
2025-06-05 19:41:14,873 - horse_racing.transformers.current_race_info - INFO - 
Dropping 1018 wide workout/past performance columns...
2025-06-05 19:41:14,897 - horse_racing.transformers.current_race_info - INFO - DataFrame shape after dropping columns: (154, 335)
2025-06-05 19:41:14,897 - horse_racing.transformers.current_race_info - INFO - Number of columns actually dropped: 997
2025-06-05 19:41:14,899 - horse_racing.transformers.current_race_info - INFO - 
Saving current race info data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\current_race_info.parquet
2025-06-05 19:41:14,959 - horse_racing.transformers.current_race_info - INFO - Save complete.
2025-06-05 19:41:14,960 - horse_racing.transformers.current_race_info - INFO - 
Output DataFrame Info:
2025-06-05 19:41:14,960 - horse_racing.transformers.current_race_info - INFO - 
--- Script Finished (2025-06-05 19:41:14 EDT) ---
2025-06-05 19:41:14,963 - __main__ - INFO - --- Step 2: Creating current race info completed ---
2025-06-05 19:41:14,964 - __main__ - INFO - --- Step 3: Transforming workouts ---
2025-06-05 19:41:14,964 - horse_racing.transformers.long_format_transformer - INFO - --- Transforming workout data ---
2025-06-05 19:41:15,216 - horse_racing.transformers.long_format_transformer - INFO - Saved workout data to C:\Users\Larry\Documents\horse_racing_project\data\processed\workouts_long_format.parquet
2025-06-05 19:41:15,219 - __main__ - INFO - --- Step 3: Transforming workouts completed ---
2025-06-05 19:41:15,220 - __main__ - INFO - --- Step 4: Transforming past starts ---
2025-06-05 19:41:15,220 - horse_racing.transformers.long_format_transformer - INFO - --- Transforming past performance data ---
2025-06-05 19:41:17,310 - horse_racing.transformers.long_format_transformer - INFO - Saved past performance data to C:\Users\Larry\Documents\horse_racing_project\data\processed\past_starts_long_format.parquet
2025-06-05 19:41:17,313 - __main__ - INFO - --- Step 4: Transforming past starts completed ---
2025-06-05 19:41:17,314 - __main__ - INFO - --- Step 5: Engineering features ---
2025-06-05 19:41:18,633 - __main__ - INFO - --- Step 5: Engineering features completed ---
2025-06-05 19:41:18,633 - __main__ - INFO - Running advanced fitness metrics...
2025-06-05 19:41:18,750 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculating all advanced fitness metrics...
2025-06-05 19:41:18,750 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculating Recovery Rate Index...
2025-06-05 19:41:18,884 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculating Form Momentum Score...
2025-06-05 19:41:19,097 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculating Cardiovascular Fitness Proxy...
2025-06-05 19:41:19,185 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculating Sectional Improvement Index...
2025-06-05 19:41:19,240 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculating Energy Distribution Profile...
2025-06-05 19:41:19,423 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculating Workout Fitness Indicators...
2025-06-05 19:41:19,643 - horse_racing.transformers.advanced_fitness_metrics - INFO - Calculated fitness metrics for 154 horses
2025-06-05 19:41:19,657 - horse_racing.transformers.advanced_fitness_metrics - INFO - Saved fitness metrics to C:\Users\Larry\Documents\horse_racing_project\data\processed\advanced_fitness_metrics.parquet
2025-06-05 19:41:19,687 - __main__ - INFO - Running sophisticated workout analysis...
2025-06-05 19:41:19,772 - horse_racing.transformers.sophisticated_workout_analysis - INFO - Calculating all workout metrics...
2025-06-05 19:41:19,773 - horse_racing.transformers.sophisticated_workout_analysis - INFO - Calculating workout quality scores...
2025-06-05 19:41:20,315 - horse_racing.transformers.sophisticated_workout_analysis - INFO - Analyzed workouts for 154 horses
2025-06-05 19:41:20,322 - horse_racing.transformers.sophisticated_workout_analysis - INFO - Saved workout analysis to C:\Users\Larry\Documents\horse_racing_project\data\processed\sophisticated_workout_analysis.parquet
2025-06-05 19:41:20,336 - __main__ - INFO - Running advanced pace projection...
2025-06-05 19:41:20,417 - horse_racing.transformers.advanced_pace_projection - INFO - Generating comprehensive pace report...
2025-06-05 19:41:20,417 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:20,655 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-05 19:41:20,656 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:20,921 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-05 19:41:20,922 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:21,165 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-05 19:41:21,165 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:21,446 - horse_racing.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-06-05 19:41:21,446 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-05 19:41:21,447 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:21,703 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-05 19:41:21,703 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:21,934 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-05 19:41:21,935 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:22,271 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-05 19:41:22,271 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:22,537 - horse_racing.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-06-05 19:41:22,538 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-05 19:41:22,538 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:22,802 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-05 19:41:22,802 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:23,030 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-05 19:41:23,031 - horse_racing.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-05 19:41:23,389 - horse_racing.transformers.advanced_pace_projection - INFO - Saved pace analysis to C:\Users\Larry\Documents\horse_racing_project\data\processed\advanced_pace_analysis.parquet
2025-06-05 19:41:23,432 - __main__ - INFO - Running multi-dimensional class assessment...
2025-06-05 19:41:23,513 - horse_racing.transformers.multi_dimensional_class_assessment - INFO - Generating comprehensive class report...
2025-06-05 19:41:23,514 - horse_racing.transformers.multi_dimensional_class_assessment - INFO - Calculating earnings-based class metrics...
2025-06-05 19:41:23,632 - horse_racing.transformers.multi_dimensional_class_assessment - INFO - Building race classification hierarchy...
2025-06-05 19:41:23,896 - horse_racing.transformers.multi_dimensional_class_assessment - INFO - Calculating hidden class indicators...
2025-06-05 19:41:24,112 - horse_racing.transformers.multi_dimensional_class_assessment - INFO - Saved class assessment to C:\Users\Larry\Documents\horse_racing_project\data\processed\multi_dimensional_class_assessment.parquet
2025-06-05 19:41:24,145 - __main__ - INFO - Running form cycle detection...
2025-06-05 19:41:24,531 - horse_racing.transformers.form_cycle_detector - INFO - Generating comprehensive form cycle report...
2025-06-05 19:41:24,532 - horse_racing.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-06-05 19:41:24,712 - horse_racing.transformers.form_cycle_detector - INFO - Analyzing position call patterns...
2025-06-05 19:41:25,087 - horse_racing.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-06-05 19:41:25,221 - horse_racing.transformers.form_cycle_detector - INFO - Analyzing fractional time evolution...
2025-06-05 19:41:25,493 - horse_racing.transformers.form_cycle_detector - INFO - Saved form cycle analysis to C:\Users\Larry\Documents\horse_racing_project\data\processed\form_cycle_analysis.parquet
2025-06-05 19:41:25,494 - horse_racing.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-06-05 19:41:25,680 - horse_racing.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-06-05 19:41:25,841 - __main__ - INFO - Running integrated analytics system...
2025-06-05 19:41:27,908 - horse_racing.transformers.integrated_analytics_system - INFO - Loading all analytical components...
2025-06-05 19:41:27,977 - horse_racing.transformers.integrated_analytics_system - INFO - Loaded fitness data: 154 records
2025-06-05 19:41:27,992 - horse_racing.transformers.integrated_analytics_system - INFO - Loaded workout data: 154 records
2025-06-05 19:41:28,011 - horse_racing.transformers.integrated_analytics_system - INFO - Loaded pace data: 142 records
2025-06-05 19:41:28,031 - horse_racing.transformers.integrated_analytics_system - INFO - Loaded class data: 154 records
2025-06-05 19:41:28,049 - horse_racing.transformers.integrated_analytics_system - INFO - Loaded form data: 154 records
2025-06-05 19:41:28,049 - horse_racing.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-06-05 19:41:28,049 - horse_racing.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-06-05 19:41:28,050 - horse_racing.transformers.integrated_analytics_system - INFO - Training form cycle state classifier...
2025-06-05 19:41:28,066 - horse_racing.transformers.integrated_analytics_system - INFO - Original class distribution for Form Cycle Classifier (y): {'FRESHENING': 48, 'DECLINING': 21, 'IMPROVING': 13, 'STABLE': 12, 'INSUFFICIENT_DATA': 10, 'RECOVERING': 9, 'ERRATIC': 5, 'PEAKING': 1}
2025-06-05 19:41:28,066 - horse_racing.transformers.integrated_analytics_system - WARNING - Stratification issue: Removing samples from classes with < 2 instances: ['PEAKING']. Number of samples removed: 1
2025-06-05 19:41:28,068 - horse_racing.transformers.integrated_analytics_system - INFO - New class distribution after filtering: {'FRESHENING': 48, 'DECLINING': 21, 'IMPROVING': 13, 'STABLE': 12, 'INSUFFICIENT_DATA': 10, 'RECOVERING': 9, 'ERRATIC': 5}
2025-06-05 19:41:28,221 - horse_racing.transformers.integrated_analytics_system - INFO - Performing workout pattern clustering...
2025-06-05 19:41:28,233 - horse_racing.transformers.integrated_analytics_system - INFO - NaNs found in workout clustering features. Imputing with median.
2025-06-05 19:41:31,457 - horse_racing.transformers.integrated_analytics_system - INFO - Training class trajectory predictor...
2025-06-05 19:41:31,968 - horse_racing.transformers.integrated_analytics_system - INFO - Training pace scenario optimizer...
2025-06-05 19:41:32,385 - horse_racing.transformers.integrated_analytics_system - INFO - Training integrated performance predictor...
2025-06-05 19:41:32,385 - horse_racing.transformers.integrated_analytics_system - INFO - Calculating composite fitness scores...
2025-06-05 19:41:32,717 - horse_racing.transformers.integrated_analytics_system - INFO - Performance predictor trained with 6 features: ['integrated_fitness_score', 'composite_fitness_score', 'workout_readiness_score', 'pace_advantage_score', 'overall_class_rating', 'composite_form_score']
2025-06-05 19:41:32,726 - horse_racing.transformers.integrated_analytics_system - INFO - Generating integrated analysis report...
2025-06-05 19:41:32,727 - horse_racing.transformers.integrated_analytics_system - INFO - Calculating composite fitness scores...
2025-06-05 19:41:32,754 - horse_racing.transformers.integrated_analytics_system - INFO - Calculating class-adjusted speed figures...
2025-06-05 19:41:33,053 - horse_racing.transformers.integrated_analytics_system - INFO - Calculating pace impact predictions...
2025-06-05 19:41:33,100 - horse_racing.transformers.integrated_analytics_system - INFO - Applied ML predictions using features: ['integrated_fitness_score', 'composite_fitness_score', 'workout_readiness_score', 'pace_advantage_score', 'overall_class_rating', 'composite_form_score']
2025-06-05 19:41:33,121 - horse_racing.transformers.integrated_analytics_system - INFO - Saved integrated report to C:\Users\Larry\Documents\horse_racing_project\data\processed\integrated_analytics_report.parquet
2025-06-05 19:41:33,318 - horse_racing.transformers.integrated_analytics_system - INFO - Saved 5 models to models
2025-06-05 19:41:33,421 - __main__ - INFO - === Pipeline completed successfully! ===
