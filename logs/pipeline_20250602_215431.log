2025-06-02 21:54:31,127 - __main__ - INFO - Pipeline started. Project Root: C:\Users\Larry\Documents\horse_racing_project
2025-06-02 21:54:31,127 - __main__ - INFO - Using settings: RAW_DATA_DIR=C:\Users\Larry\Documents\horse_racing_project\data\raw, PROCESSED_DATA_DIR=C:\Users\Larry\Documents\horse_racing_project\data\processed, CACHE_DIR=C:\Users\Larry\Documents\horse_racing_project\data\cache
2025-06-02 21:54:31,128 - __main__ - INFO - === Starting Horse Racing Data Pipeline ===
2025-06-02 21:54:31,128 - __main__ - INFO - Searching for DRF files in: C:\Users\Larry\Documents\horse_racing_project\data\raw with pattern: '*DRF'
2025-06-02 21:54:31,130 - __main__ - INFO - Using DRF file: CDX0503.DRF
2025-06-02 21:54:31,131 - __main__ - INFO - --- Step 1: Parsing DRF file (using src/parsers/bris_spec_new.py) ---
2025-06-02 21:54:31,131 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() starting ---
2025-06-02 21:54:31,131 - src.parsers.bris_spec_new - INFO - Processing DRF file provided as argument: C:\Users\Larry\Documents\horse_racing_project\data\raw\CDX0503.DRF
2025-06-02 21:54:31,132 - src.parsers.bris_spec_new - INFO - Loading specification cache from: C:\Users\Larry\Documents\horse_racing_project\data\cache\bris_spec.pkl
2025-06-02 21:54:31,134 - src.parsers.bris_spec_new - INFO - Parsing field types from: C:\Users\Larry\Documents\horse_racing_project\data\raw\bris_dict.txt
2025-06-02 21:54:31,146 - src.parsers.bris_spec_new - INFO - Parsed types for 190 fields from bris_dict.txt.
2025-06-02 21:54:31,147 - src.parsers.bris_spec_new - INFO - 
Attempting to parse CDX0503.DRF as comma-delimited...
2025-06-02 21:54:31,147 - src.parsers.bris_spec_new - INFO - Excluding columns starting with 'reserved'. Using 1321 out of 1435 columns.
2025-06-02 21:54:31,252 - src.parsers.bris_spec_new - INFO - Parsing successful. Read 187 lines from CDX0503.DRF.
2025-06-02 21:54:31,253 - src.parsers.bris_spec_new - INFO - 
Identifying column types using parsed bris_dict.txt info...
2025-06-02 21:54:31,300 - src.parsers.bris_spec_new - INFO - Identified 123 numeric columns using spec.
2025-06-02 21:54:31,300 - src.parsers.bris_spec_new - INFO - Identified 21 date columns using spec.
2025-06-02 21:54:31,301 - src.parsers.bris_spec_new - INFO - 
Attempting data type conversions...
2025-06-02 21:54:31,303 - src.parsers.bris_spec_new - INFO - Converting 123 columns to numeric...
2025-06-02 21:54:31,327 - src.parsers.bris_spec_new - INFO - Successfully converted 123 numeric columns.
2025-06-02 21:54:31,328 - src.parsers.bris_spec_new - INFO - Converting 21 columns to datetime...
2025-06-02 21:54:31,340 - src.parsers.bris_spec_new - INFO - Successfully converted 21 date columns.
2025-06-02 21:54:31,356 - src.parsers.bris_spec_new - INFO - 
Saving the processed data to Parquet file: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-02 21:54:31,526 - src.parsers.bris_spec_new - INFO - 
Successfully saved final data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-02 21:54:31,527 - src.parsers.bris_spec_new - INFO - Final DataFrame shape: (187, 1332)
2025-06-02 21:54:31,527 - src.parsers.bris_spec_new - INFO - Final DataFrame Info:
2025-06-02 21:54:31,527 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() finished ---
2025-06-02 21:54:31,529 - __main__ - INFO - --- Step 1: Parsing DRF file completed ---
2025-06-02 21:54:31,529 - __main__ - INFO - --- Step 2: Creating current race info ---
2025-06-02 21:54:31,588 - src.transformers.current_race_info - INFO - --- Creating Current Race Info File (2025-06-02 21:54:31 EDT) ---
2025-06-02 21:54:31,588 - src.transformers.current_race_info - INFO - Loading wide format data from: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-02 21:54:31,724 - src.transformers.current_race_info - INFO - Loaded wide data with shape: (187, 1332)
2025-06-02 21:54:31,730 - src.transformers.current_race_info - INFO - 
Dropping 1018 wide workout/past performance columns...
2025-06-02 21:54:31,744 - src.transformers.current_race_info - INFO - DataFrame shape after dropping columns: (187, 335)
2025-06-02 21:54:31,744 - src.transformers.current_race_info - INFO - Number of columns actually dropped: 997
2025-06-02 21:54:31,746 - src.transformers.current_race_info - INFO - 
Saving current race info data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\current_race_info.parquet
2025-06-02 21:54:31,785 - src.transformers.current_race_info - INFO - Save complete.
2025-06-02 21:54:31,785 - src.transformers.current_race_info - INFO - 
Output DataFrame Info:
2025-06-02 21:54:31,785 - src.transformers.current_race_info - INFO - 
--- Script Finished (2025-06-02 21:54:31 EDT) ---
2025-06-02 21:54:31,787 - __main__ - INFO - --- Step 2: Creating current race info completed ---
2025-06-02 21:54:31,788 - __main__ - INFO - --- Step 3: Transforming workouts ---
2025-06-02 21:54:31,788 - src.transformers.transform_workouts - INFO - --- Starting Workout Data Reshaping (2025-06-02 21:54:31 EDT) ---
2025-06-02 21:54:31,895 - src.transformers.transform_workouts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-06-02 21:54:31,895 - src.transformers.transform_workouts - INFO - Reshaping workout data using specification (Field# -> Actual Column Label)...
2025-06-02 21:54:31,909 - src.transformers.transform_workouts - INFO - Concatenating data for all workouts...
2025-06-02 21:54:31,913 - src.transformers.transform_workouts - INFO - Raw concatenated workout data shape: (2244, 14)
2025-06-02 21:54:31,924 - src.transformers.transform_workouts - INFO - Saving long format workout data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\workouts_long_format.parquet
2025-06-02 21:54:31,935 - src.transformers.transform_workouts - INFO - Save complete.
2025-06-02 21:54:31,935 - src.transformers.transform_workouts - INFO - Output DataFrame Info:
2025-06-02 21:54:31,939 - src.transformers.transform_workouts - INFO - --- Workout Reshaping Script Finished (2025-06-02 21:54:31 EDT) ---
2025-06-02 21:54:31,941 - __main__ - INFO - --- Step 3: Transforming workouts completed ---
2025-06-02 21:54:31,941 - __main__ - INFO - --- Step 4: Transforming past starts ---
2025-06-02 21:54:31,941 - src.transformers.transform_past_starts - INFO - --- Starting Past Performance Data Reshaping (2025-06-02 21:54:31 EDT) ---
2025-06-02 21:54:32,048 - src.transformers.transform_past_starts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-06-02 21:54:32,048 - src.transformers.transform_past_starts - INFO - Reshaping past performance data using specification and pd.melt...
2025-06-02 21:54:32,461 - src.transformers.transform_past_starts - INFO - Joining 94 melted metric DataFrames...
2025-06-02 21:54:32,462 - src.transformers.transform_past_starts - INFO -   Starting join with 'pp_race_date' (1870 rows)
2025-06-02 21:54:32,464 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_days_since_prev' (1683 rows)
2025-06-02 21:54:32,467 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 7)
2025-06-02 21:54:32,469 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code' (1870 rows)
2025-06-02 21:54:32,473 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 8)
2025-06-02 21:54:32,473 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code_bris' (1870 rows)
2025-06-02 21:54:32,478 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 9)
2025-06-02 21:54:32,479 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_num' (1870 rows)
2025-06-02 21:54:32,483 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 10)
2025-06-02 21:54:32,484 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_condition' (1870 rows)
2025-06-02 21:54:32,488 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 11)
2025-06-02 21:54:32,489 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_distance' (1870 rows)
2025-06-02 21:54:32,493 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 12)
2025-06-02 21:54:32,494 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_surface' (1870 rows)
2025-06-02 21:54:32,498 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 13)
2025-06-02 21:54:32,499 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_chute_indicator' (1870 rows)
2025-06-02 21:54:32,503 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 14)
2025-06-02 21:54:32,504 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_num_entrants' (1870 rows)
2025-06-02 21:54:32,509 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 15)
2025-06-02 21:54:32,510 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_post_position' (1870 rows)
2025-06-02 21:54:32,514 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 16)
2025-06-02 21:54:32,515 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_equipment' (1870 rows)
2025-06-02 21:54:32,520 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 17)
2025-06-02 21:54:32,521 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_racename' (1870 rows)
2025-06-02 21:54:32,525 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 18)
2025-06-02 21:54:32,526 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_medication' (1870 rows)
2025-06-02 21:54:32,530 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 19)
2025-06-02 21:54:32,531 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trip_comment' (1870 rows)
2025-06-02 21:54:32,537 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 20)
2025-06-02 21:54:32,538 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_name' (1870 rows)
2025-06-02 21:54:32,543 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 21)
2025-06-02 21:54:32,544 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_name' (1870 rows)
2025-06-02 21:54:32,549 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 22)
2025-06-02 21:54:32,550 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_name' (1870 rows)
2025-06-02 21:54:32,555 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 23)
2025-06-02 21:54:32,555 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_weight' (1870 rows)
2025-06-02 21:54:32,560 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 24)
2025-06-02 21:54:32,562 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_weight' (1870 rows)
2025-06-02 21:54:32,567 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 25)
2025-06-02 21:54:32,569 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_weight' (1870 rows)
2025-06-02 21:54:32,573 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 26)
2025-06-02 21:54:32,574 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_margin' (1870 rows)
2025-06-02 21:54:32,579 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 27)
2025-06-02 21:54:32,580 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_margin' (1870 rows)
2025-06-02 21:54:32,585 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 28)
2025-06-02 21:54:32,586 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_margin' (1870 rows)
2025-06-02 21:54:32,590 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 29)
2025-06-02 21:54:32,591 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_extra_comment' (1870 rows)
2025-06-02 21:54:32,595 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 30)
2025-06-02 21:54:32,596 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_weight_carried' (1870 rows)
2025-06-02 21:54:32,601 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 31)
2025-06-02 21:54:32,602 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_odds' (1870 rows)
2025-06-02 21:54:32,606 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 32)
2025-06-02 21:54:32,607 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_entry_indicator' (1870 rows)
2025-06-02 21:54:32,612 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 33)
2025-06-02 21:54:32,613 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_classification' (1870 rows)
2025-06-02 21:54:32,618 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 34)
2025-06-02 21:54:32,619 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claiming_price' (1870 rows)
2025-06-02 21:54:32,624 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 35)
2025-06-02 21:54:32,625 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_purse' (1870 rows)
2025-06-02 21:54:32,629 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 36)
2025-06-02 21:54:32,630 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_call_pos' (1870 rows)
2025-06-02 21:54:32,635 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 37)
2025-06-02 21:54:32,636 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_pos' (1870 rows)
2025-06-02 21:54:32,640 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 38)
2025-06-02 21:54:32,641 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_pos' (1870 rows)
2025-06-02 21:54:32,646 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 39)
2025-06-02 21:54:32,647 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_gate_call_pos' (1870 rows)
2025-06-02 21:54:32,654 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 40)
2025-06-02 21:54:32,655 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_pos' (1870 rows)
2025-06-02 21:54:32,660 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 41)
2025-06-02 21:54:32,661 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_pos' (1870 rows)
2025-06-02 21:54:32,666 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 42)
2025-06-02 21:54:32,667 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_money_pos' (1870 rows)
2025-06-02 21:54:32,672 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 43)
2025-06-02 21:54:32,674 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_leader' (1870 rows)
2025-06-02 21:54:32,679 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 44)
2025-06-02 21:54:32,679 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_behind' (1870 rows)
2025-06-02 21:54:32,685 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 45)
2025-06-02 21:54:32,686 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_leader' (1870 rows)
2025-06-02 21:54:32,690 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 46)
2025-06-02 21:54:32,691 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_behind' (1870 rows)
2025-06-02 21:54:32,696 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 47)
2025-06-02 21:54:32,697 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_leader' (1870 rows)
2025-06-02 21:54:32,704 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 48)
2025-06-02 21:54:32,705 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_behind' (1870 rows)
2025-06-02 21:54:32,709 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 49)
2025-06-02 21:54:32,711 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_1st_call' (1870 rows)
2025-06-02 21:54:32,716 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 50)
2025-06-02 21:54:32,718 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_leader' (1870 rows)
2025-06-02 21:54:32,722 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 51)
2025-06-02 21:54:32,723 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_behind' (1870 rows)
2025-06-02 21:54:32,728 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 52)
2025-06-02 21:54:32,730 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_winner' (1870 rows)
2025-06-02 21:54:32,736 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 53)
2025-06-02 21:54:32,737 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_behind' (1870 rows)
2025-06-02 21:54:32,743 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 54)
2025-06-02 21:54:32,744 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_2nd_call' (1870 rows)
2025-06-02 21:54:32,750 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 55)
2025-06-02 21:54:32,751 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_2f_pace' (1870 rows)
2025-06-02 21:54:32,756 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 56)
2025-06-02 21:54:32,758 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_4f_pace' (1870 rows)
2025-06-02 21:54:32,763 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 57)
2025-06-02 21:54:32,764 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_6f_pace' (1870 rows)
2025-06-02 21:54:32,771 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 58)
2025-06-02 21:54:32,772 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_8f_pace' (1870 rows)
2025-06-02 21:54:32,778 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 59)
2025-06-02 21:54:32,779 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_10f_pace' (1870 rows)
2025-06-02 21:54:32,786 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 60)
2025-06-02 21:54:32,787 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_late_pace' (1870 rows)
2025-06-02 21:54:32,792 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 61)
2025-06-02 21:54:32,793 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_rating' (1870 rows)
2025-06-02 21:54:32,799 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 62)
2025-06-02 21:54:32,800 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_speed_rating_alt' (1870 rows)
2025-06-02 21:54:32,806 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 63)
2025-06-02 21:54:32,808 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_variant' (1870 rows)
2025-06-02 21:54:32,814 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 64)
2025-06-02 21:54:32,815 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_2f' (1870 rows)
2025-06-02 21:54:32,822 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 65)
2025-06-02 21:54:32,823 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_3f' (1870 rows)
2025-06-02 21:54:32,829 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 66)
2025-06-02 21:54:32,831 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_4f' (1870 rows)
2025-06-02 21:54:32,838 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 67)
2025-06-02 21:54:32,839 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_5f' (1870 rows)
2025-06-02 21:54:32,845 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 68)
2025-06-02 21:54:32,846 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_6f' (1870 rows)
2025-06-02 21:54:32,853 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 69)
2025-06-02 21:54:32,854 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_7f' (1870 rows)
2025-06-02 21:54:32,861 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 70)
2025-06-02 21:54:32,862 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_8f' (1870 rows)
2025-06-02 21:54:32,870 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 71)
2025-06-02 21:54:32,871 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_10f' (1870 rows)
2025-06-02 21:54:32,879 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 72)
2025-06-02 21:54:32,880 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_12f' (1870 rows)
2025-06-02 21:54:32,888 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 73)
2025-06-02 21:54:32,889 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_14f' (1870 rows)
2025-06-02 21:54:32,897 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 74)
2025-06-02 21:54:32,898 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_16f' (1870 rows)
2025-06-02 21:54:32,906 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 75)
2025-06-02 21:54:32,907 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_1' (1870 rows)
2025-06-02 21:54:32,913 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 76)
2025-06-02 21:54:32,914 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_2' (1870 rows)
2025-06-02 21:54:32,922 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 77)
2025-06-02 21:54:32,924 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_3' (1870 rows)
2025-06-02 21:54:32,931 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 78)
2025-06-02 21:54:32,932 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_final_time' (1870 rows)
2025-06-02 21:54:32,939 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 79)
2025-06-02 21:54:32,941 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claimed_code' (1870 rows)
2025-06-02 21:54:32,948 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 80)
2025-06-02 21:54:32,949 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trainer' (1870 rows)
2025-06-02 21:54:32,957 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 81)
2025-06-02 21:54:32,958 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_jockey' (1870 rows)
2025-06-02 21:54:32,965 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 82)
2025-06-02 21:54:32,967 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_apprentice_allow' (1870 rows)
2025-06-02 21:54:32,975 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 83)
2025-06-02 21:54:32,976 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_type' (1870 rows)
2025-06-02 21:54:32,984 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 84)
2025-06-02 21:54:32,986 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_age_sex_restrict' (1870 rows)
2025-06-02 21:54:32,993 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 85)
2025-06-02 21:54:32,995 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_statebred_flag' (1870 rows)
2025-06-02 21:54:33,004 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 86)
2025-06-02 21:54:33,005 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_restricted_flag' (1870 rows)
2025-06-02 21:54:33,014 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 87)
2025-06-02 21:54:33,015 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_favorite_indicator' (1870 rows)
2025-06-02 21:54:33,023 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 88)
2025-06-02 21:54:33,025 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_front_bandages' (1870 rows)
2025-06-02 21:54:33,033 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 89)
2025-06-02 21:54:33,034 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_par' (1870 rows)
2025-06-02 21:54:33,042 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 90)
2025-06-02 21:54:33,043 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bar_shoe' (1870 rows)
2025-06-02 21:54:33,053 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 91)
2025-06-02 21:54:33,054 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_company_line' (1870 rows)
2025-06-02 21:54:33,062 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 92)
2025-06-02 21:54:33,064 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_low_claiming' (1870 rows)
2025-06-02 21:54:33,073 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 93)
2025-06-02 21:54:33,074 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_high_claiming' (1870 rows)
2025-06-02 21:54:33,084 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 94)
2025-06-02 21:54:33,086 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_misc_code' (1870 rows)
2025-06-02 21:54:33,097 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 95)
2025-06-02 21:54:33,099 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_ext_start_comment' (1870 rows)
2025-06-02 21:54:33,111 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 96)
2025-06-02 21:54:33,112 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_sealed_track' (1870 rows)
2025-06-02 21:54:33,126 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 97)
2025-06-02 21:54:33,128 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_aw_surface_flag' (1870 rows)
2025-06-02 21:54:33,142 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 98)
2025-06-02 21:54:33,143 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_eqb_conditions' (1870 rows)
2025-06-02 21:54:33,154 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 99)
2025-06-02 21:54:33,215 - src.transformers.transform_past_starts - INFO -   Added 'pp_distance_type' classification to past starts.
2025-06-02 21:54:33,726 - src.transformers.transform_past_starts - INFO - Saving long format past performance data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\past_starts_long_format.parquet
2025-06-02 21:54:33,752 - src.transformers.transform_past_starts - INFO - Save complete.
2025-06-02 21:54:33,752 - src.transformers.transform_past_starts - INFO - Output DataFrame Info:
2025-06-02 21:54:33,755 - src.transformers.transform_past_starts - INFO - --- Past Performance Reshaping Script Finished (2025-06-02 21:54:33 EDT) ---
2025-06-02 21:54:33,761 - __main__ - INFO - --- Step 4: Transforming past starts completed ---
2025-06-02 21:54:33,762 - __main__ - INFO - --- Step 5: Engineering features ---
2025-06-02 21:54:34,756 - __main__ - INFO - --- Step 5: Engineering features completed ---
2025-06-02 21:54:34,756 - __main__ - INFO - Running advanced fitness metrics...
2025-06-02 21:54:34,829 - src.transformers.advanced_fitness_metrics - INFO - Calculating all advanced fitness metrics...
2025-06-02 21:54:34,829 - src.transformers.advanced_fitness_metrics - INFO - Calculating Recovery Rate Index...
2025-06-02 21:54:34,972 - src.transformers.advanced_fitness_metrics - INFO - Calculating Form Momentum Score...
2025-06-02 21:54:35,204 - src.transformers.advanced_fitness_metrics - INFO - Calculating Cardiovascular Fitness Proxy...
2025-06-02 21:54:35,295 - src.transformers.advanced_fitness_metrics - INFO - Calculating Sectional Improvement Index...
2025-06-02 21:54:35,352 - src.transformers.advanced_fitness_metrics - INFO - Calculating Energy Distribution Profile...
2025-06-02 21:54:35,542 - src.transformers.advanced_fitness_metrics - INFO - Calculating Workout Fitness Indicators...
2025-06-02 21:54:35,740 - src.transformers.advanced_fitness_metrics - INFO - Calculated fitness metrics for 187 horses
2025-06-02 21:54:35,749 - src.transformers.advanced_fitness_metrics - INFO - Saved fitness metrics to data\processed\advanced_fitness_metrics.parquet
2025-06-02 21:54:35,768 - __main__ - INFO - Running sophisticated workout analysis...
2025-06-02 21:54:35,823 - src.transformers.sophisticated_workout_analysis - INFO - Calculating all workout metrics...
2025-06-02 21:54:35,823 - src.transformers.sophisticated_workout_analysis - INFO - Calculating workout quality scores...
2025-06-02 21:54:36,135 - src.transformers.sophisticated_workout_analysis - INFO - Identifying trainer intent signals...
2025-06-02 21:54:36,687 - src.transformers.sophisticated_workout_analysis - INFO - Analyzed workouts for 187 horses
2025-06-02 21:54:36,688 - src.transformers.sophisticated_workout_analysis - INFO - Generating trainer pattern report...
2025-06-02 21:54:36,688 - src.transformers.sophisticated_workout_analysis - INFO - Analyzing trainer-specific workout patterns...
2025-06-02 21:54:37,294 - src.transformers.sophisticated_workout_analysis - INFO - Analyzing work-to-race translation...
2025-06-02 21:54:39,100 - src.transformers.sophisticated_workout_analysis - INFO - Saved workout analysis to data\processed\sophisticated_workout_analysis.parquet
2025-06-02 21:54:39,102 - src.transformers.sophisticated_workout_analysis - INFO - Saved trainer patterns to data\processed\trainer_workout_patterns.csv
2025-06-02 21:54:39,104 - src.transformers.sophisticated_workout_analysis - INFO - Saved translation analysis to data\processed\workout_race_translation.csv
2025-06-02 21:54:39,126 - __main__ - INFO - Running advanced pace projection...
2025-06-02 21:54:39,179 - src.transformers.advanced_pace_projection - INFO - Generating comprehensive pace report...
2025-06-02 21:54:39,180 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:39,427 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 21:54:39,427 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:39,703 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-02 21:54:39,704 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:39,951 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 21:54:39,952 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:40,246 - src.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-06-02 21:54:40,247 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 21:54:40,247 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:40,519 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-02 21:54:40,520 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:40,766 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 21:54:40,766 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:41,095 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 21:54:41,096 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:41,368 - src.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-06-02 21:54:41,369 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 21:54:41,369 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:41,640 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-02 21:54:41,641 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:41,886 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 21:54:41,886 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 21:54:42,207 - src.transformers.advanced_pace_projection - INFO - Saved pace analysis to data\processed\advanced_pace_analysis.parquet
2025-06-02 21:54:42,238 - __main__ - INFO - Running multi-dimensional class assessment...
2025-06-02 21:54:42,286 - src.transformers.multi_dimensional_class_assessment - INFO - Generating comprehensive class report...
2025-06-02 21:54:42,287 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating earnings-based class metrics...
2025-06-02 21:54:42,407 - src.transformers.multi_dimensional_class_assessment - INFO - Building race classification hierarchy...
2025-06-02 21:54:42,668 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating hidden class indicators...
2025-06-02 21:54:42,853 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating competitive level index...
2025-06-02 21:54:43,239 - src.transformers.multi_dimensional_class_assessment - INFO - Saved class assessment to data\processed\multi_dimensional_class_assessment.parquet
2025-06-02 21:54:43,267 - __main__ - INFO - Running form cycle detection...
2025-06-02 21:54:43,354 - src.transformers.form_cycle_detector - INFO - Generating comprehensive form cycle report...
2025-06-02 21:54:43,355 - src.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-06-02 21:54:43,596 - src.transformers.form_cycle_detector - INFO - Analyzing position call patterns...
2025-06-02 21:54:44,046 - src.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-06-02 21:54:44,196 - src.transformers.form_cycle_detector - INFO - Analyzing fractional time evolution...
2025-06-02 21:54:44,459 - src.transformers.form_cycle_detector - INFO - Calculating field-adjusted performance...
2025-06-02 21:54:44,597 - src.transformers.form_cycle_detector - INFO - Saved form cycle analysis to data\processed\form_cycle_analysis.parquet
2025-06-02 21:54:44,598 - src.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-06-02 21:54:44,798 - src.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-06-02 21:54:44,973 - __main__ - INFO - Running integrated analytics system...
2025-06-02 21:54:45,234 - src.transformers.integrated_analytics_system - INFO - Loading all analytical components...
2025-06-02 21:54:45,292 - src.transformers.integrated_analytics_system - INFO - Loaded fitness data: 187 records
2025-06-02 21:54:45,305 - src.transformers.integrated_analytics_system - INFO - Loaded workout data: 187 records
2025-06-02 21:54:45,317 - src.transformers.integrated_analytics_system - INFO - Loaded pace data: 185 records
2025-06-02 21:54:45,333 - src.transformers.integrated_analytics_system - INFO - Loaded class data: 187 records
2025-06-02 21:54:45,348 - src.transformers.integrated_analytics_system - INFO - Loaded form data: 187 records
2025-06-02 21:54:45,349 - src.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-06-02 21:54:45,349 - src.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-06-02 21:54:45,349 - src.transformers.integrated_analytics_system - INFO - Training form cycle state classifier...
2025-06-02 21:54:45,362 - src.transformers.integrated_analytics_system - INFO - Original class distribution for Form Cycle Classifier (y): {'FRESHENING': 122, 'STABLE': 15, 'DECLINING': 13, 'IMPROVING': 6, 'INSUFFICIENT_DATA': 5, 'RECOVERING': 3, 'ERRATIC': 1}
2025-06-02 21:54:45,364 - src.transformers.integrated_analytics_system - WARNING - Stratification issue: Removing samples from classes with < 2 instances: ['ERRATIC']. Number of samples removed: 1
2025-06-02 21:54:45,365 - src.transformers.integrated_analytics_system - INFO - New class distribution after filtering: {'FRESHENING': 122, 'STABLE': 15, 'DECLINING': 13, 'IMPROVING': 6, 'INSUFFICIENT_DATA': 5, 'RECOVERING': 3}
2025-06-02 21:54:45,486 - src.transformers.integrated_analytics_system - INFO - Performing workout pattern clustering...
2025-06-02 21:54:45,496 - __main__ - ERROR - Pipeline failed with an unexpected error: Input X contains NaN.
KMeans does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
Traceback (most recent call last):
  File "C:\Users\Larry\Documents\horse_racing_project\run_pipeline.py", line 155, in run_complete_pipeline
    run_integrated_analytics()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Larry\Documents\horse_racing_project\src\transformers\integrated_analytics_system.py", line 1181, in main
    ml_results = analytics.train_ml_models()
  File "C:\Users\Larry\Documents\horse_racing_project\src\transformers\integrated_analytics_system.py", line 524, in train_ml_models
    workout_clusters = self._perform_workout_clustering()
  File "C:\Users\Larry\Documents\horse_racing_project\src\transformers\integrated_analytics_system.py", line 698, in _perform_workout_clustering
    clusters = kmeans.fit_predict(X_scaled)
  File "C:\Users\Larry\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\cluster\_kmeans.py", line 1064, in fit_predict
    return self.fit(X, sample_weight=sample_weight).labels_
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Larry\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\Users\Larry\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\cluster\_kmeans.py", line 1454, in fit
    X = validate_data(
        self,
    ...<5 lines>...
        accept_large_sparse=False,
    )
  File "C:\Users\Larry\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
  File "C:\Users\Larry\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 1107, in check_array
    _assert_all_finite(
    ~~~~~~~~~~~~~~~~~~^
        array,
        ^^^^^^
    ...<2 lines>...
        allow_nan=ensure_all_finite == "allow-nan",
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Larry\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X,
        ^^
    ...<4 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Larry\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
KMeans does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
