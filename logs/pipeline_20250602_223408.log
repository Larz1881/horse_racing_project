2025-06-02 22:34:08,388 - __main__ - INFO - Pipeline started. Project Root: C:\Users\Larry\Documents\horse_racing_project
2025-06-02 22:34:08,388 - __main__ - INFO - Using settings: RAW_DATA_DIR=C:\Users\Larry\Documents\horse_racing_project\data\raw, PROCESSED_DATA_DIR=C:\Users\Larry\Documents\horse_racing_project\data\processed, CACHE_DIR=C:\Users\Larry\Documents\horse_racing_project\data\cache
2025-06-02 22:34:08,388 - __main__ - INFO - === Starting Horse Racing Data Pipeline ===
2025-06-02 22:34:08,389 - __main__ - INFO - Searching for DRF files in: C:\Users\Larry\Documents\horse_racing_project\data\raw with pattern: '*DRF'
2025-06-02 22:34:08,391 - __main__ - INFO - Using DRF file: CDX0503.DRF
2025-06-02 22:34:08,391 - __main__ - INFO - --- Step 1: Parsing DRF file (using src/parsers/bris_spec_new.py) ---
2025-06-02 22:34:08,392 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() starting ---
2025-06-02 22:34:08,392 - src.parsers.bris_spec_new - INFO - Processing DRF file provided as argument: C:\Users\Larry\Documents\horse_racing_project\data\raw\CDX0503.DRF
2025-06-02 22:34:08,392 - src.parsers.bris_spec_new - INFO - Loading specification cache from: C:\Users\Larry\Documents\horse_racing_project\data\cache\bris_spec.pkl
2025-06-02 22:34:08,395 - src.parsers.bris_spec_new - INFO - Parsing field types from: C:\Users\Larry\Documents\horse_racing_project\data\raw\bris_dict.txt
2025-06-02 22:34:08,407 - src.parsers.bris_spec_new - INFO - Parsed types for 190 fields from bris_dict.txt.
2025-06-02 22:34:08,408 - src.parsers.bris_spec_new - INFO - 
Attempting to parse CDX0503.DRF as comma-delimited...
2025-06-02 22:34:08,408 - src.parsers.bris_spec_new - INFO - Excluding columns starting with 'reserved'. Using 1321 out of 1435 columns.
2025-06-02 22:34:08,515 - src.parsers.bris_spec_new - INFO - Parsing successful. Read 187 lines from CDX0503.DRF.
2025-06-02 22:34:08,516 - src.parsers.bris_spec_new - INFO - 
Identifying column types using parsed bris_dict.txt info...
2025-06-02 22:34:08,566 - src.parsers.bris_spec_new - INFO - Identified 123 numeric columns using spec.
2025-06-02 22:34:08,566 - src.parsers.bris_spec_new - INFO - Identified 21 date columns using spec.
2025-06-02 22:34:08,567 - src.parsers.bris_spec_new - INFO - 
Attempting data type conversions...
2025-06-02 22:34:08,569 - src.parsers.bris_spec_new - INFO - Converting 123 columns to numeric...
2025-06-02 22:34:08,593 - src.parsers.bris_spec_new - INFO - Successfully converted 123 numeric columns.
2025-06-02 22:34:08,594 - src.parsers.bris_spec_new - INFO - Converting 21 columns to datetime...
2025-06-02 22:34:08,605 - src.parsers.bris_spec_new - INFO - Successfully converted 21 date columns.
2025-06-02 22:34:08,620 - src.parsers.bris_spec_new - INFO - 
Saving the processed data to Parquet file: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-02 22:34:08,787 - src.parsers.bris_spec_new - INFO - 
Successfully saved final data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-02 22:34:08,787 - src.parsers.bris_spec_new - INFO - Final DataFrame shape: (187, 1332)
2025-06-02 22:34:08,787 - src.parsers.bris_spec_new - INFO - Final DataFrame Info:
2025-06-02 22:34:08,788 - src.parsers.bris_spec_new - INFO - --- bris_spec_new.main() finished ---
2025-06-02 22:34:08,790 - __main__ - INFO - --- Step 1: Parsing DRF file completed ---
2025-06-02 22:34:08,791 - __main__ - INFO - --- Step 2: Creating current race info ---
2025-06-02 22:34:08,856 - src.transformers.current_race_info - INFO - --- Creating Current Race Info File (2025-06-02 22:34:08 EDT) ---
2025-06-02 22:34:08,857 - src.transformers.current_race_info - INFO - Loading wide format data from: C:\Users\Larry\Documents\horse_racing_project\data\processed\parsed_race_data_full.parquet
2025-06-02 22:34:09,007 - src.transformers.current_race_info - INFO - Loaded wide data with shape: (187, 1332)
2025-06-02 22:34:09,013 - src.transformers.current_race_info - INFO - 
Dropping 1018 wide workout/past performance columns...
2025-06-02 22:34:09,026 - src.transformers.current_race_info - INFO - DataFrame shape after dropping columns: (187, 335)
2025-06-02 22:34:09,027 - src.transformers.current_race_info - INFO - Number of columns actually dropped: 997
2025-06-02 22:34:09,028 - src.transformers.current_race_info - INFO - 
Saving current race info data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\current_race_info.parquet
2025-06-02 22:34:09,068 - src.transformers.current_race_info - INFO - Save complete.
2025-06-02 22:34:09,069 - src.transformers.current_race_info - INFO - 
Output DataFrame Info:
2025-06-02 22:34:09,069 - src.transformers.current_race_info - INFO - 
--- Script Finished (2025-06-02 22:34:09 EDT) ---
2025-06-02 22:34:09,072 - __main__ - INFO - --- Step 2: Creating current race info completed ---
2025-06-02 22:34:09,072 - __main__ - INFO - --- Step 3: Transforming workouts ---
2025-06-02 22:34:09,072 - src.transformers.transform_workouts - INFO - --- Starting Workout Data Reshaping (2025-06-02 22:34:09 EDT) ---
2025-06-02 22:34:09,184 - src.transformers.transform_workouts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-06-02 22:34:09,184 - src.transformers.transform_workouts - INFO - Reshaping workout data using specification (Field# -> Actual Column Label)...
2025-06-02 22:34:09,199 - src.transformers.transform_workouts - INFO - Concatenating data for all workouts...
2025-06-02 22:34:09,203 - src.transformers.transform_workouts - INFO - Raw concatenated workout data shape: (2244, 14)
2025-06-02 22:34:09,213 - src.transformers.transform_workouts - INFO - Saving long format workout data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\workouts_long_format.parquet
2025-06-02 22:34:09,225 - src.transformers.transform_workouts - INFO - Save complete.
2025-06-02 22:34:09,226 - src.transformers.transform_workouts - INFO - Output DataFrame Info:
2025-06-02 22:34:09,229 - src.transformers.transform_workouts - INFO - --- Workout Reshaping Script Finished (2025-06-02 22:34:09 EDT) ---
2025-06-02 22:34:09,232 - __main__ - INFO - --- Step 3: Transforming workouts completed ---
2025-06-02 22:34:09,233 - __main__ - INFO - --- Step 4: Transforming past starts ---
2025-06-02 22:34:09,233 - src.transformers.transform_past_starts - INFO - --- Starting Past Performance Data Reshaping (2025-06-02 22:34:09 EDT) ---
2025-06-02 22:34:09,340 - src.transformers.transform_past_starts - INFO - Using ID Variables: ['track', 'race', 'post_position', 'horse_name']
2025-06-02 22:34:09,341 - src.transformers.transform_past_starts - INFO - Reshaping past performance data using specification and pd.melt...
2025-06-02 22:34:09,771 - src.transformers.transform_past_starts - INFO - Joining 94 melted metric DataFrames...
2025-06-02 22:34:09,771 - src.transformers.transform_past_starts - INFO -   Starting join with 'pp_race_date' (1870 rows)
2025-06-02 22:34:09,772 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_days_since_prev' (1683 rows)
2025-06-02 22:34:09,776 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 7)
2025-06-02 22:34:09,777 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code' (1870 rows)
2025-06-02 22:34:09,781 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 8)
2025-06-02 22:34:09,782 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_code_bris' (1870 rows)
2025-06-02 22:34:09,786 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 9)
2025-06-02 22:34:09,786 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_num' (1870 rows)
2025-06-02 22:34:09,790 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 10)
2025-06-02 22:34:09,790 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_condition' (1870 rows)
2025-06-02 22:34:09,794 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 11)
2025-06-02 22:34:09,794 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_distance' (1870 rows)
2025-06-02 22:34:09,799 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 12)
2025-06-02 22:34:09,800 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_surface' (1870 rows)
2025-06-02 22:34:09,804 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 13)
2025-06-02 22:34:09,806 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_chute_indicator' (1870 rows)
2025-06-02 22:34:09,810 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 14)
2025-06-02 22:34:09,810 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_num_entrants' (1870 rows)
2025-06-02 22:34:09,814 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 15)
2025-06-02 22:34:09,815 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_post_position' (1870 rows)
2025-06-02 22:34:09,819 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 16)
2025-06-02 22:34:09,819 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_equipment' (1870 rows)
2025-06-02 22:34:09,823 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 17)
2025-06-02 22:34:09,824 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_racename' (1870 rows)
2025-06-02 22:34:09,828 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 18)
2025-06-02 22:34:09,830 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_medication' (1870 rows)
2025-06-02 22:34:09,834 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 19)
2025-06-02 22:34:09,836 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trip_comment' (1870 rows)
2025-06-02 22:34:09,839 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 20)
2025-06-02 22:34:09,840 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_name' (1870 rows)
2025-06-02 22:34:09,845 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 21)
2025-06-02 22:34:09,847 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_name' (1870 rows)
2025-06-02 22:34:09,850 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 22)
2025-06-02 22:34:09,852 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_name' (1870 rows)
2025-06-02 22:34:09,857 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 23)
2025-06-02 22:34:09,858 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_weight' (1870 rows)
2025-06-02 22:34:09,862 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 24)
2025-06-02 22:34:09,863 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_weight' (1870 rows)
2025-06-02 22:34:09,867 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 25)
2025-06-02 22:34:09,869 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_weight' (1870 rows)
2025-06-02 22:34:09,873 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 26)
2025-06-02 22:34:09,873 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_winner_margin' (1870 rows)
2025-06-02 22:34:09,878 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 27)
2025-06-02 22:34:09,879 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_margin' (1870 rows)
2025-06-02 22:34:09,884 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 28)
2025-06-02 22:34:09,885 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_third_margin' (1870 rows)
2025-06-02 22:34:09,889 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 29)
2025-06-02 22:34:09,891 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_extra_comment' (1870 rows)
2025-06-02 22:34:09,895 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 30)
2025-06-02 22:34:09,896 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_weight_carried' (1870 rows)
2025-06-02 22:34:09,901 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 31)
2025-06-02 22:34:09,902 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_odds' (1870 rows)
2025-06-02 22:34:09,906 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 32)
2025-06-02 22:34:09,908 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_entry_indicator' (1870 rows)
2025-06-02 22:34:09,912 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 33)
2025-06-02 22:34:09,914 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_classification' (1870 rows)
2025-06-02 22:34:09,918 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 34)
2025-06-02 22:34:09,919 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claiming_price' (1870 rows)
2025-06-02 22:34:09,923 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 35)
2025-06-02 22:34:09,924 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_purse' (1870 rows)
2025-06-02 22:34:09,928 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 36)
2025-06-02 22:34:09,929 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_call_pos' (1870 rows)
2025-06-02 22:34:09,934 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 37)
2025-06-02 22:34:09,935 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_pos' (1870 rows)
2025-06-02 22:34:09,940 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 38)
2025-06-02 22:34:09,941 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_pos' (1870 rows)
2025-06-02 22:34:09,946 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 39)
2025-06-02 22:34:09,947 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_gate_call_pos' (1870 rows)
2025-06-02 22:34:09,952 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 40)
2025-06-02 22:34:09,953 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_pos' (1870 rows)
2025-06-02 22:34:09,957 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 41)
2025-06-02 22:34:09,958 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_pos' (1870 rows)
2025-06-02 22:34:09,964 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 42)
2025-06-02 22:34:09,965 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_money_pos' (1870 rows)
2025-06-02 22:34:09,970 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 43)
2025-06-02 22:34:09,971 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_leader' (1870 rows)
2025-06-02 22:34:09,975 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 44)
2025-06-02 22:34:09,976 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_start_lengths_behind' (1870 rows)
2025-06-02 22:34:09,981 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 45)
2025-06-02 22:34:09,982 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_leader' (1870 rows)
2025-06-02 22:34:09,987 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 46)
2025-06-02 22:34:09,988 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_first_call_lengths_behind' (1870 rows)
2025-06-02 22:34:09,994 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 47)
2025-06-02 22:34:09,995 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_leader' (1870 rows)
2025-06-02 22:34:10,001 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 48)
2025-06-02 22:34:10,001 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_second_call_lengths_behind' (1870 rows)
2025-06-02 22:34:10,006 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 49)
2025-06-02 22:34:10,007 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_1st_call' (1870 rows)
2025-06-02 22:34:10,012 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 50)
2025-06-02 22:34:10,014 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_leader' (1870 rows)
2025-06-02 22:34:10,019 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 51)
2025-06-02 22:34:10,020 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_stretch_lengths_behind' (1870 rows)
2025-06-02 22:34:10,025 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 52)
2025-06-02 22:34:10,027 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_winner' (1870 rows)
2025-06-02 22:34:10,033 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 53)
2025-06-02 22:34:10,034 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_finish_lengths_behind' (1870 rows)
2025-06-02 22:34:10,040 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 54)
2025-06-02 22:34:10,041 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_shape_2nd_call' (1870 rows)
2025-06-02 22:34:10,047 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 55)
2025-06-02 22:34:10,049 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_2f_pace' (1870 rows)
2025-06-02 22:34:10,054 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 56)
2025-06-02 22:34:10,055 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_4f_pace' (1870 rows)
2025-06-02 22:34:10,061 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 57)
2025-06-02 22:34:10,062 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_6f_pace' (1870 rows)
2025-06-02 22:34:10,068 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 58)
2025-06-02 22:34:10,069 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_8f_pace' (1870 rows)
2025-06-02 22:34:10,074 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 59)
2025-06-02 22:34:10,075 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_10f_pace' (1870 rows)
2025-06-02 22:34:10,082 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 60)
2025-06-02 22:34:10,083 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_late_pace' (1870 rows)
2025-06-02 22:34:10,089 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 61)
2025-06-02 22:34:10,090 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_rating' (1870 rows)
2025-06-02 22:34:10,098 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 62)
2025-06-02 22:34:10,099 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_speed_rating_alt' (1870 rows)
2025-06-02 22:34:10,104 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 63)
2025-06-02 22:34:10,105 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_track_variant' (1870 rows)
2025-06-02 22:34:10,111 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 64)
2025-06-02 22:34:10,112 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_2f' (1870 rows)
2025-06-02 22:34:10,118 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 65)
2025-06-02 22:34:10,120 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_3f' (1870 rows)
2025-06-02 22:34:10,126 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 66)
2025-06-02 22:34:10,128 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_4f' (1870 rows)
2025-06-02 22:34:10,134 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 67)
2025-06-02 22:34:10,136 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_5f' (1870 rows)
2025-06-02 22:34:10,142 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 68)
2025-06-02 22:34:10,143 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_6f' (1870 rows)
2025-06-02 22:34:10,150 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 69)
2025-06-02 22:34:10,151 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_7f' (1870 rows)
2025-06-02 22:34:10,156 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 70)
2025-06-02 22:34:10,157 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_8f' (1870 rows)
2025-06-02 22:34:10,164 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 71)
2025-06-02 22:34:10,165 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_10f' (1870 rows)
2025-06-02 22:34:10,172 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 72)
2025-06-02 22:34:10,173 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_12f' (1870 rows)
2025-06-02 22:34:10,180 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 73)
2025-06-02 22:34:10,181 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_14f' (1870 rows)
2025-06-02 22:34:10,188 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 74)
2025-06-02 22:34:10,190 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_frac_16f' (1870 rows)
2025-06-02 22:34:10,196 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 75)
2025-06-02 22:34:10,198 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_1' (1870 rows)
2025-06-02 22:34:10,204 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 76)
2025-06-02 22:34:10,205 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_2' (1870 rows)
2025-06-02 22:34:10,214 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 77)
2025-06-02 22:34:10,215 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_fraction_3' (1870 rows)
2025-06-02 22:34:10,221 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 78)
2025-06-02 22:34:10,222 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_final_time' (1870 rows)
2025-06-02 22:34:10,229 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 79)
2025-06-02 22:34:10,231 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_claimed_code' (1870 rows)
2025-06-02 22:34:10,238 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 80)
2025-06-02 22:34:10,239 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_trainer' (1870 rows)
2025-06-02 22:34:10,247 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 81)
2025-06-02 22:34:10,248 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_jockey' (1870 rows)
2025-06-02 22:34:10,255 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 82)
2025-06-02 22:34:10,257 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_apprentice_allow' (1870 rows)
2025-06-02 22:34:10,265 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 83)
2025-06-02 22:34:10,266 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_race_type' (1870 rows)
2025-06-02 22:34:10,273 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 84)
2025-06-02 22:34:10,274 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_age_sex_restrict' (1870 rows)
2025-06-02 22:34:10,283 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 85)
2025-06-02 22:34:10,284 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_statebred_flag' (1870 rows)
2025-06-02 22:34:10,291 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 86)
2025-06-02 22:34:10,292 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_restricted_flag' (1870 rows)
2025-06-02 22:34:10,300 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 87)
2025-06-02 22:34:10,301 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_favorite_indicator' (1870 rows)
2025-06-02 22:34:10,308 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 88)
2025-06-02 22:34:10,309 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_front_bandages' (1870 rows)
2025-06-02 22:34:10,317 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 89)
2025-06-02 22:34:10,318 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bris_speed_par' (1870 rows)
2025-06-02 22:34:10,326 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 90)
2025-06-02 22:34:10,327 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_bar_shoe' (1870 rows)
2025-06-02 22:34:10,336 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 91)
2025-06-02 22:34:10,337 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_company_line' (1870 rows)
2025-06-02 22:34:10,344 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 92)
2025-06-02 22:34:10,345 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_low_claiming' (1870 rows)
2025-06-02 22:34:10,353 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 93)
2025-06-02 22:34:10,354 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_high_claiming' (1870 rows)
2025-06-02 22:34:10,360 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 94)
2025-06-02 22:34:10,361 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_misc_code' (1870 rows)
2025-06-02 22:34:10,371 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 95)
2025-06-02 22:34:10,372 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_ext_start_comment' (1870 rows)
2025-06-02 22:34:10,384 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 96)
2025-06-02 22:34:10,385 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_sealed_track' (1870 rows)
2025-06-02 22:34:10,396 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 97)
2025-06-02 22:34:10,398 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_aw_surface_flag' (1870 rows)
2025-06-02 22:34:10,409 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 98)
2025-06-02 22:34:10,410 - src.transformers.transform_past_starts - INFO -   Merging with 'pp_eqb_conditions' (1870 rows)
2025-06-02 22:34:10,423 - src.transformers.transform_past_starts - INFO -   Shape after merge: (1870, 99)
2025-06-02 22:34:10,488 - src.transformers.transform_past_starts - INFO -   Added 'pp_distance_type' classification to past starts.
2025-06-02 22:34:10,980 - src.transformers.transform_past_starts - INFO - Saving long format past performance data to: C:\Users\Larry\Documents\horse_racing_project\data\processed\past_starts_long_format.parquet
2025-06-02 22:34:11,005 - src.transformers.transform_past_starts - INFO - Save complete.
2025-06-02 22:34:11,006 - src.transformers.transform_past_starts - INFO - Output DataFrame Info:
2025-06-02 22:34:11,009 - src.transformers.transform_past_starts - INFO - --- Past Performance Reshaping Script Finished (2025-06-02 22:34:11 EDT) ---
2025-06-02 22:34:11,015 - __main__ - INFO - --- Step 4: Transforming past starts completed ---
2025-06-02 22:34:11,016 - __main__ - INFO - --- Step 5: Engineering features ---
2025-06-02 22:34:12,004 - __main__ - INFO - --- Step 5: Engineering features completed ---
2025-06-02 22:34:12,005 - __main__ - INFO - Running advanced fitness metrics...
2025-06-02 22:34:12,078 - src.transformers.advanced_fitness_metrics - INFO - Calculating all advanced fitness metrics...
2025-06-02 22:34:12,079 - src.transformers.advanced_fitness_metrics - INFO - Calculating Recovery Rate Index...
2025-06-02 22:34:12,221 - src.transformers.advanced_fitness_metrics - INFO - Calculating Form Momentum Score...
2025-06-02 22:34:12,448 - src.transformers.advanced_fitness_metrics - INFO - Calculating Cardiovascular Fitness Proxy...
2025-06-02 22:34:12,538 - src.transformers.advanced_fitness_metrics - INFO - Calculating Sectional Improvement Index...
2025-06-02 22:34:12,598 - src.transformers.advanced_fitness_metrics - INFO - Calculating Energy Distribution Profile...
2025-06-02 22:34:12,790 - src.transformers.advanced_fitness_metrics - INFO - Calculating Workout Fitness Indicators...
2025-06-02 22:34:12,987 - src.transformers.advanced_fitness_metrics - INFO - Calculated fitness metrics for 187 horses
2025-06-02 22:34:12,998 - src.transformers.advanced_fitness_metrics - INFO - Saved fitness metrics to data\processed\advanced_fitness_metrics.parquet
2025-06-02 22:34:13,017 - __main__ - INFO - Running sophisticated workout analysis...
2025-06-02 22:34:13,073 - src.transformers.sophisticated_workout_analysis - INFO - Calculating all workout metrics...
2025-06-02 22:34:13,074 - src.transformers.sophisticated_workout_analysis - INFO - Calculating workout quality scores...
2025-06-02 22:34:13,392 - src.transformers.sophisticated_workout_analysis - INFO - Identifying trainer intent signals...
2025-06-02 22:34:13,943 - src.transformers.sophisticated_workout_analysis - INFO - Analyzed workouts for 187 horses
2025-06-02 22:34:13,945 - src.transformers.sophisticated_workout_analysis - INFO - Generating trainer pattern report...
2025-06-02 22:34:13,945 - src.transformers.sophisticated_workout_analysis - INFO - Analyzing trainer-specific workout patterns...
2025-06-02 22:34:14,559 - src.transformers.sophisticated_workout_analysis - INFO - Analyzing work-to-race translation...
2025-06-02 22:34:16,360 - src.transformers.sophisticated_workout_analysis - INFO - Saved workout analysis to data\processed\sophisticated_workout_analysis.parquet
2025-06-02 22:34:16,362 - src.transformers.sophisticated_workout_analysis - INFO - Saved trainer patterns to data\processed\trainer_workout_patterns.csv
2025-06-02 22:34:16,363 - src.transformers.sophisticated_workout_analysis - INFO - Saved translation analysis to data\processed\workout_race_translation.csv
2025-06-02 22:34:16,387 - __main__ - INFO - Running advanced pace projection...
2025-06-02 22:34:16,437 - src.transformers.advanced_pace_projection - INFO - Generating comprehensive pace report...
2025-06-02 22:34:16,437 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:16,684 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 22:34:16,685 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:16,957 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-02 22:34:16,958 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:17,209 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 22:34:17,209 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:17,500 - src.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-06-02 22:34:17,500 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 22:34:17,501 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:17,775 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-02 22:34:17,775 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:18,018 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 22:34:18,019 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:18,351 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 22:34:18,351 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:18,619 - src.transformers.advanced_pace_projection - INFO - Classifying pace shapes...
2025-06-02 22:34:18,619 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 22:34:18,620 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:18,891 - src.transformers.advanced_pace_projection - INFO - Calculating energy cost model...
2025-06-02 22:34:18,892 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:19,138 - src.transformers.advanced_pace_projection - INFO - Calculating pace pressure...
2025-06-02 22:34:19,139 - src.transformers.advanced_pace_projection - INFO - Calculating multi-factor pace model...
2025-06-02 22:34:19,457 - src.transformers.advanced_pace_projection - INFO - Saved pace analysis to data\processed\advanced_pace_analysis.parquet
2025-06-02 22:34:19,486 - __main__ - INFO - Running multi-dimensional class assessment...
2025-06-02 22:34:19,535 - src.transformers.multi_dimensional_class_assessment - INFO - Generating comprehensive class report...
2025-06-02 22:34:19,535 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating earnings-based class metrics...
2025-06-02 22:34:19,654 - src.transformers.multi_dimensional_class_assessment - INFO - Building race classification hierarchy...
2025-06-02 22:34:19,919 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating hidden class indicators...
2025-06-02 22:34:20,103 - src.transformers.multi_dimensional_class_assessment - INFO - Calculating competitive level index...
2025-06-02 22:34:20,490 - src.transformers.multi_dimensional_class_assessment - INFO - Saved class assessment to data\processed\multi_dimensional_class_assessment.parquet
2025-06-02 22:34:20,518 - __main__ - INFO - Running form cycle detection...
2025-06-02 22:34:20,611 - src.transformers.form_cycle_detector - INFO - Generating comprehensive form cycle report...
2025-06-02 22:34:20,611 - src.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-06-02 22:34:20,852 - src.transformers.form_cycle_detector - INFO - Analyzing position call patterns...
2025-06-02 22:34:21,269 - src.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-06-02 22:34:21,421 - src.transformers.form_cycle_detector - INFO - Analyzing fractional time evolution...
2025-06-02 22:34:21,683 - src.transformers.form_cycle_detector - INFO - Calculating field-adjusted performance...
2025-06-02 22:34:21,816 - src.transformers.form_cycle_detector - INFO - Saved form cycle analysis to data\processed\form_cycle_analysis.parquet
2025-06-02 22:34:21,817 - src.transformers.form_cycle_detector - INFO - Analyzing beaten lengths trajectory...
2025-06-02 22:34:22,019 - src.transformers.form_cycle_detector - INFO - Detecting form cycle patterns...
2025-06-02 22:34:22,185 - __main__ - INFO - Running integrated analytics system...
2025-06-02 22:34:22,437 - src.transformers.integrated_analytics_system - INFO - Loading all analytical components...
2025-06-02 22:34:22,494 - src.transformers.integrated_analytics_system - INFO - Loaded fitness data: 187 records
2025-06-02 22:34:22,508 - src.transformers.integrated_analytics_system - INFO - Loaded workout data: 187 records
2025-06-02 22:34:22,521 - src.transformers.integrated_analytics_system - INFO - Loaded pace data: 185 records
2025-06-02 22:34:22,538 - src.transformers.integrated_analytics_system - INFO - Loaded class data: 187 records
2025-06-02 22:34:22,556 - src.transformers.integrated_analytics_system - INFO - Loaded form data: 187 records
2025-06-02 22:34:22,556 - src.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-06-02 22:34:22,556 - src.transformers.integrated_analytics_system - INFO - Training machine learning models...
2025-06-02 22:34:22,557 - src.transformers.integrated_analytics_system - INFO - Training form cycle state classifier...
2025-06-02 22:34:22,568 - src.transformers.integrated_analytics_system - INFO - Original class distribution for Form Cycle Classifier (y): {'FRESHENING': 70, 'DECLINING': 34, 'STABLE': 33, 'IMPROVING': 12, 'RECOVERING': 6, 'INSUFFICIENT_DATA': 5, 'ERRATIC': 4, 'PEAKING': 1}
2025-06-02 22:34:22,569 - src.transformers.integrated_analytics_system - WARNING - Stratification issue: Removing samples from classes with < 2 instances: ['PEAKING']. Number of samples removed: 1
2025-06-02 22:34:22,571 - src.transformers.integrated_analytics_system - INFO - New class distribution after filtering: {'FRESHENING': 70, 'DECLINING': 34, 'STABLE': 33, 'IMPROVING': 12, 'RECOVERING': 6, 'INSUFFICIENT_DATA': 5, 'ERRATIC': 4}
2025-06-02 22:34:22,684 - src.transformers.integrated_analytics_system - INFO - Performing workout pattern clustering...
2025-06-02 22:34:22,693 - src.transformers.integrated_analytics_system - INFO - NaNs found in workout clustering features. Imputing with median.
2025-06-02 22:34:24,387 - src.transformers.integrated_analytics_system - INFO - Training class trajectory predictor...
2025-06-02 22:34:24,743 - src.transformers.integrated_analytics_system - INFO - Training pace scenario optimizer...
2025-06-02 22:34:25,020 - src.transformers.integrated_analytics_system - INFO - Training integrated performance predictor...
2025-06-02 22:34:25,021 - src.transformers.integrated_analytics_system - INFO - Calculating composite fitness scores...
2025-06-02 22:34:25,216 - src.transformers.integrated_analytics_system - INFO - Performance predictor trained with 6 features: ['integrated_fitness_score', 'composite_fitness_score', 'workout_readiness_score', 'pace_advantage_score', 'overall_class_rating', 'composite_form_score']
2025-06-02 22:34:25,222 - src.transformers.integrated_analytics_system - INFO - Generating integrated analysis report...
2025-06-02 22:34:25,222 - src.transformers.integrated_analytics_system - INFO - Calculating composite fitness scores...
2025-06-02 22:34:25,236 - src.transformers.integrated_analytics_system - INFO - Calculating class-adjusted speed figures...
2025-06-02 22:34:25,466 - src.transformers.integrated_analytics_system - INFO - Calculating pace impact predictions...
2025-06-02 22:34:25,493 - src.transformers.integrated_analytics_system - INFO - Applied ML predictions using features: ['integrated_fitness_score', 'composite_fitness_score', 'workout_readiness_score', 'pace_advantage_score', 'overall_class_rating', 'composite_form_score']
2025-06-02 22:34:25,509 - src.transformers.integrated_analytics_system - INFO - Saved integrated report to data\processed\integrated_analytics_report.parquet
2025-06-02 22:34:25,609 - src.transformers.integrated_analytics_system - INFO - Saved 5 models to models
2025-06-02 22:34:25,669 - __main__ - INFO - === Pipeline completed successfully! ===
